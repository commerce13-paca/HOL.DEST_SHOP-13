<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Meta Admaven -->
    <meta name='admaven-placement' content="Bqja5pjUF">
    
    <!-- SEO OptimisÃ© -->
    <title>H.D.S SHOP - Organisation Ã‰vÃ©nements & Boutique Premium | Marseille</title>
    <meta name="description" content="H.D.S SHOP - Organisation d'Ã©vÃ©nements Ã  Marseille. Anniversaires enfants/ados/adultes, Ã©vÃ©nements entreprises, mariages, soirÃ©es privÃ©es. Livraison 24h/24.">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph -->
    <meta property="og:title" content="H.D.S SHOP - Organisation Ã‰vÃ©nements & Boutique Premium">
    <meta property="og:description" content="Organisation complÃ¨te d'Ã©vÃ©nements Ã  Marseille. Anniversaires, soirÃ©es, Ã©vÃ©nements pros. Service premium avec livraison 24h/24.">
    <meta property="og:image" content="https://mcusercontent.com/40a9f1a77d46874eba2309d88/images/89a59702-cad3-dfb7-580d-22fb843f8d3f.jpeg">
    <meta property="og:url" content="https://web-site13015.github.io/H_D_S-SHOP/">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="fr_FR">
    
    <!-- PayPal SDK (Client ID factice - REMPLACEZ PAR LE VÃ”TRE) -->
    <script src="https://www.paypal.com/sdk/js?client-id=test&currency=EUR"></script>
    
    <!-- Liens ressources externes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Spice&family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="https://kit.fontawesome.com/90a4d1138d.js" crossorigin="anonymous"></script>
    
    <!-- Leaflet pour la carte -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- FullCalendar -->
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/fr.js'></script>
    
    <!-- Chat Widget -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŽ‰</text></svg>">
    
    <style>
        /* ==================== VOTRE STYLE EXISTANT ICI (INCHANGÃ‰) ==================== */
        /* === RESET & BASE STYLES === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --primary-yellow: #FFD700;
            --primary-gold: #FFC107;
            --primary-black: #000000;
            --primary-white: #FFFFFF;
            --dark-bg: #0A0A0A;
            --card-bg: #111111;
            --gray-100: #F5F5F5;
            --gray-200: #EEEEEE;
            --gray-300: #E0E0E0;
            --gray-400: #BDBDBD;
            --gray-500: #9E9E9E;
            --gray-600: #757575;
            --gray-700: #616161;
            --gray-800: #424242;
            --gray-900: #212121;
            
            --accent-red: #FF5252;
            --accent-green: #4CAF50;
            --accent-blue: #2196F3;
            --accent-purple: #9C27B0;
            --accent-pink: #E91E63;
            --accent-orange: #FF9800;
            --accent-cyan: #00BCD4;
            
            --shadow-xs: 0 1px 3px rgba(0,0,0,0.12);
            --shadow-sm: 0 4px 6px rgba(0,0,0,0.08);
            --shadow-md: 0 6px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 10px 28px rgba(0,0,0,0.16);
            --shadow-xl: 0 20px 40px rgba(0,0,0,0.2);
            --shadow-glow: 0 0 30px rgba(255, 215, 0, 0.3);
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --radius-2xl: 24px;
            --radius-full: 9999px;
            
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
            
            --container-max: 420px;
            
            /* Variables pour mode nuit/jour */
            --bg-color: #0A0A0A;
            --text-color: #F5F5F5;
            --card-color: #111111;
            --border-color: rgba(255,255,255,0.1);
        }
        
        /* Mode jour */
        body.light-mode {
            --bg-color: #f8f9fa;
            --text-color: #212121;
            --card-color: #ffffff;
            --border-color: rgba(0,0,0,0.1);
            --dark-bg: #f8f9fa;
            --card-bg: #ffffff;
            --gray-100: #212121;
            --gray-200: #424242;
            --gray-300: #616161;
            --gray-400: #757575;
            --gray-500: #9E9E9E;
            --gray-600: #BDBDBD;
            --gray-700: #E0E0E0;
            --gray-800: #EEEEEE;
            --gray-900: #F5F5F5;
        }
        
        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color 0.3s, color 0.3s;
        }
        
        /* === MAIN CONTAINER === */
        .main-container {
            width: 100%;
            max-width: var(--container-max);
            margin: 0 auto;
            position: relative;
        }
        
        .profile-container {
            background: var(--card-bg);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            padding: 0;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 215, 0, 0.1);
            transition: background-color 0.3s, border-color 0.3s;
        }
        
        .profile-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                var(--primary-yellow), 
                var(--accent-orange),
                var(--primary-yellow)
            );
            background-size: 200% 100%;
            animation: shimmer 3s infinite linear;
        }
        
        /* === HEADER COMPACT AVEC BOUTON COMPTE ET MENU === */
        .app-header {
            background: linear-gradient(135deg, var(--bg-color) 0%, var(--card-color) 100%);
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
            position: relative;
            transition: background 0.3s;
        }
        
        .logo-wrapper {
            position: relative;
            width: 70px;
            height: 70px;
            flex-shrink: 0;
        }
        
        .logo-image {
            width: 100%;
            height: 100%;
            border-radius: var(--radius-lg);
            border: 2px solid var(--primary-yellow);
            object-fit: cover;
            background: var(--gray-900);
            box-shadow: var(--shadow-md);
            cursor: pointer;
        }
        
        .logo-star {
            position: absolute;
            bottom: -5px;
            right: -5px;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, var(--primary-yellow), #FFC107);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 
                0 4px 8px rgba(255, 215, 0, 0.3),
                0 0 0 2px rgba(0,0,0,0.8);
            border: 2px solid #000;
            z-index: 3;
            animation: pulse 2s infinite;
        }
        
        .logo-star::before {
            content: 'â˜…';
            color: var(--primary-black);
            font-size: 16px;
            font-weight: 900;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        
        .header-content {
            flex: 1;
        }
        
        .header-title {
            font-family: 'Bungee Spice', cursive;
            font-size: 26px;
            line-height: 1;
            margin-bottom: 4px;
        }
        
        .header-subtitle {
            font-size: 12px;
            color: var(--gray-400);
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        
        .header-tag {
            display: inline-block;
            background: rgba(255, 215, 0, 0.1);
            color: var(--primary-yellow);
            padding: 4px 10px;
            border-radius: var(--radius-full);
            font-size: 11px;
            font-weight: 600;
        }
        
        /* === BOUTON MENU PRINCIPAL === */
        .menu-button {
            position: absolute;
            top: 15px;
            right: 60px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-normal);
            z-index: 10;
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid rgba(255, 215, 0, 0.3);
        }
        
        .menu-button:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: rotate(90deg);
        }
        
        .menu-button i {
            color: var(--primary-yellow);
            font-size: 18px;
        }
        
        /* === MENU VERTICAL === */
        .vertical-menu {
            position: fixed;
            top: 0;
            right: -300px;
            width: 280px;
            height: 100vh;
            background: var(--card-bg);
            z-index: 2000;
            transition: var(--transition-normal);
            box-shadow: var(--shadow-xl);
            border-left: 1px solid rgba(255, 215, 0, 0.2);
            display: flex;
            flex-direction: column;
        }
        
        .vertical-menu.active {
            right: 0;
        }
        
        .menu-header {
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 152, 0, 0.1));
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .menu-header h3 {
            font-size: 18px;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .menu-close {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-color);
            width: 35px;
            height: 35px;
            border-radius: var(--radius-full);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition-fast);
        }
        
        .menu-close:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: rgba(255, 215, 0, 0.4);
            transform: rotate(90deg);
        }
        
        .menu-items {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-md);
            margin-bottom: 10px;
            cursor: pointer;
            transition: var(--transition-fast);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .menu-item:hover {
            background: rgba(255, 215, 0, 0.1);
            border-color: rgba(255, 215, 0, 0.2);
            transform: translateX(-5px);
        }
        
        .menu-item i {
            width: 24px;
            text-align: center;
            color: var(--primary-yellow);
            font-size: 18px;
        }
        
        .menu-item-text {
            flex: 1;
            font-weight: 500;
            color: var(--text-color);
        }
        
        .menu-item-value {
            font-size: 12px;
            color: var(--gray-400);
            background: rgba(255, 255, 255, 0.1);
            padding: 3px 8px;
            border-radius: var(--radius-full);
        }
        
        /* === BOUTON COMPTE UTILISATEUR === */
        .account-button {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-normal);
            z-index: 10;
            border: 2px solid transparent;
        }
        
        .account-button.connected {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            border-color: rgba(76, 175, 80, 0.3);
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.3);
        }
        
        .account-button.disconnected {
            background: linear-gradient(135deg, var(--gray-700), var(--gray-800));
            border-color: rgba(255, 215, 0, 0.2);
        }
        
        .account-button i {
            color: var(--primary-white);
            font-size: 18px;
        }
        
        .account-button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
        }
        
        /* === COMPACT STATUS === */
        .status-bar {
            background: rgba(255, 215, 0, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.1);
            border-radius: var(--radius-md);
            padding: 12px 15px;
            margin: 15px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition-fast);
        }
        
        .status-bar:hover {
            background: rgba(255, 215, 0, 0.1);
        }
        
        .status-text {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary-yellow);
            font-family: 'Bungee Spice', cursive;
        }
        
        /* === NAVIGATION RAPIDE AMÃ‰LIORÃ‰E === */
        .quick-nav {
            display: flex;
            justify-content: space-around;
            padding: 12px 15px;
            background: rgba(255, 215, 0, 0.05);
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
            flex-wrap: nowrap;
            overflow-x: auto;
            scrollbar-width: none;
        }
        
        .quick-nav::-webkit-scrollbar {
            display: none;
        }
        
        .quick-nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            background: none;
            border: none;
            color: var(--gray-400);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: var(--radius-md);
            transition: var(--transition-fast);
            flex-shrink: 0;
            white-space: nowrap;
            position: relative;
        }
        
        .quick-nav-btn i {
            font-size: 18px;
        }
        
        .quick-nav-btn:hover {
            background: rgba(255, 215, 0, 0.1);
            color: var(--primary-yellow);
            transform: translateY(-2px);
        }
        
        .quick-nav-btn.active {
            background: rgba(255, 215, 0, 0.15);
            color: var(--primary-yellow);
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.2);
        }
        
        .nav-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent-red);
            color: white;
            font-size: 10px;
            font-weight: 800;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* === BOUTON DE LOCALISATION === */
        .location-button {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            padding: 10px 15px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: var(--transition-normal);
            margin: 10px auto;
            width: 90%;
            box-shadow: var(--shadow-md);
        }
        
        .location-button:hover {
            background: linear-gradient(135deg, #1976D2, #2196F3);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .location-button:disabled {
            background: var(--gray-600);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .distance-display {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: var(--radius-md);
            padding: 10px;
            margin: 10px 0;
            text-align: center;
            font-size: 14px;
            color: var(--primary-yellow);
            font-weight: 600;
            display: none;
        }
        
        /* === APP STYLE CARDS === */
        .app-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            padding: 18px;
            margin: 15px;
            box-shadow: var(--shadow-md);
            transition: background-color 0.3s, border-color 0.3s;
        }
        
        body.light-mode .app-card {
            background: rgba(0, 0, 0, 0.03);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-color);
            margin-bottom: 15px;
        }
        
        /* === BOUTIQUE DETAILS COMPACT === */
        .shop-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .detail-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-md);
            padding: 12px;
            text-align: center;
            transition: var(--transition-fast);
        }
        
        body.light-mode .detail-item {
            background: rgba(0, 0, 0, 0.03);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .detail-item:hover {
            background: rgba(255, 215, 0, 0.05);
            transform: translateY(-2px);
        }
        
        .detail-icon {
            font-size: 20px;
            margin-bottom: 8px;
            color: var(--primary-yellow);
        }
        
        .detail-text {
            font-size: 12px;
            color: var(--gray-400);
            line-height: 1.3;
        }
        
        .detail-value {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-color);
            margin-top: 4px;
        }
        
        /* === DELIVERY MAP COMPACT === */
        .map-container {
            height: 250px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--radius-md);
            overflow: hidden;
            border: 2px solid rgba(255, 215, 0, 0.2);
            margin-bottom: 10px;
        }
        
        .map-legend {
            display: flex;
            justify-content: space-around;
            font-size: 11px;
            color: var(--gray-400);
            padding: 10px 0;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            border: 1px solid white;
        }
        
        .legend-free { background: #4CAF50; }
        .legend-1eur { background: #FF9800; }
        .legend-2eur { background: #FF5252; }
        .legend-3eur { background: #9C27B0; }
        .legend-5eur { background: #2196F3; }
        
        /* === LIVE TRACKER COMPACT === */
        .tracker-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 215, 0, 0.05);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 215, 0, 0.1);
        }
        
        .driver-avatar {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .tracker-info {
            flex: 1;
        }
        
        .tracker-status {
            display: inline-block;
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            padding: 4px 10px;
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 8px;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }
        
        .driver-name {
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 4px;
            font-size: 14px;
        }
        
        .driver-eta {
            font-size: 12px;
            color: var(--primary-yellow);
        }
        
        /* === PROGRESS TRACKER STYLES === */
        .progress-tracker {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 215, 0, 0.1);
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .progress-title {
            font-weight: 700;
            color: var(--text-color);
            font-size: 14px;
        }
        
        .progress-percentage {
            font-weight: 800;
            color: var(--primary-yellow);
            font-size: 14px;
        }
        
        .progress-bar-container {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-full);
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-yellow), #FF9800);
            border-radius: var(--radius-full);
            width: 0%;
            transition: width 0.5s ease-in-out;
        }
        
        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
        }
        
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 2;
            position: relative;
        }
        
        .step-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-white);
            border: 2px solid var(--gray-400);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 5px;
            transition: all 0.3s;
        }
        
        .step-icon.active {
            background: var(--primary-yellow);
            border-color: var(--primary-yellow);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .step-icon.completed {
            background: #4CAF50;
            border-color: #4CAF50;
        }
        
        .step-icon.completed::after {
            content: 'âœ“';
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .step-label {
            font-size: 10px;
            font-weight: 600;
            color: var(--gray-400);
            text-align: center;
            max-width: 60px;
        }
        
        .step-label.active {
            color: var(--primary-yellow);
            font-weight: 700;
        }
        
        .step-label.completed {
            color: #4CAF50;
        }
        
        .progress-time {
            text-align: center;
            font-size: 11px;
            color: var(--gray-500);
            margin-top: 8px;
        }
        
        /* === PRODUCTS GRID IMPROVED === */
        .products-section {
            padding: 15px;
        }
        
        .category-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 5px;
            scrollbar-width: none;
        }
        
        .category-tabs::-webkit-scrollbar {
            display: none;
        }
        
        .category-tab {
            padding: 10px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--gray-300);
            border-radius: var(--radius-full);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-fast);
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        body.light-mode .category-tab {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .category-tab.active {
            background: rgba(255, 215, 0, 0.2);
            border-color: rgba(255, 215, 0, 0.4);
            color: var(--primary-yellow);
        }
        
        .category-tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .product-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            padding: 15px;
            transition: var(--transition-normal);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        body.light-mode .product-card {
            background: rgba(0, 0, 0, 0.03);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .product-card:hover {
            background: rgba(255, 255,255, 0.08);
            border-color: rgba(255, 215, 0, 0.3);
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        
        .product-image-container {
            position: relative;
            width: 100%;
            height: 140px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--radius-md);
            overflow: hidden;
            margin-bottom: 12px;
        }
        
        .product-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 10px;
            transition: var(--transition-normal);
            cursor: pointer;
        }
        
        .product-image:hover {
            transform: scale(1.05);
        }
        
        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            padding: 3px 8px;
            border-radius: var(--radius-full);
            font-size: 10px;
            font-weight: 700;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }
        
        .product-name {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 8px;
            line-height: 1.4;
            height: 42px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        .product-price {
            font-size: 20px;
            font-weight: 800;
            color: var(--primary-yellow);
            margin-bottom: 12px;
        }
        
        .product-price .original-price {
            font-size: 14px;
            color: var(--gray-500);
            text-decoration: line-through;
            margin-right: 5px;
        }
        
        .product-price .discounted-price {
            color: #4CAF50;
        }
        
        .product-price .client-badge {
            display: inline-block;
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            padding: 2px 6px;
            border-radius: var(--radius-full);
            font-size: 10px;
            font-weight: 700;
            margin-left: 5px;
            vertical-align: middle;
        }
        
        .product-description {
            font-size: 12px;
            color: var(--gray-400);
            margin-bottom: 12px;
            line-height: 1.4;
            height: 34px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        .product-details-btn {
            background: rgba(255, 215, 0, 0.1);
            color: var(--primary-yellow);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: var(--radius-md);
            padding: 6px 12px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 12px;
            transition: var(--transition-fast);
        }
        
        .product-details-btn:hover {
            background: rgba(255, 215, 0, 0.2);
        }
        
        .product-actions {
            display: flex;
            gap: 8px;
            margin-top: auto;
        }
        
        .quantity-selector {
            flex: 1;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            overflow: hidden;
        }
        
        body.light-mode .quantity-selector {
            background: rgba(0, 0, 0, 0.1);
        }
        
        .quantity-btn {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: none;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition-fast);
        }
        
        body.light-mode .quantity-btn {
            background: rgba(0, 0, 0, 0.15);
            color: var(--text-color);
        }
        
        .quantity-btn:hover {
            background: rgba(255, 215, 0, 0.3);
        }
        
        .quantity-input {
            width: 35px;
            height: 32px;
            text-align: center;
            border: none;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 14px;
            font-weight: 600;
        }
        
        body.light-mode .quantity-input {
            background: rgba(0, 0, 0, 0.05);
            color: var(--text-color);
        }
        
        .buy-button {
            flex: 2;
            height: 32px;
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition-normal);
        }
        
        .buy-button:hover {
            background: linear-gradient(135deg, #2E7D32, #4CAF50);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .buy-button:disabled {
            background: var(--gray-600);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* === TABLEAU DE PRIX DYNAMIQUE POUR Ã‰VÃ‰NEMENTS === */
        .pricing-table {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-lg);
            padding: 15px;
            margin: 15px 0;
            border: 1px solid rgba(255, 215, 0, 0.1);
        }
        
        body.light-mode .pricing-table {
            background: rgba(0, 0, 0, 0.03);
        }
        
        .pricing-table h4 {
            color: var(--primary-yellow);
            margin-bottom: 10px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .pricing-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        body.light-mode .pricing-option {
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .pricing-option:last-child {
            border-bottom: none;
        }
        
        .person-count {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--gray-300);
            font-size: 14px;
        }
        
        .person-count i {
            color: var(--primary-yellow);
        }
        
        .event-price {
            font-weight: 700;
            color: var(--primary-yellow);
            font-size: 18px;
        }
        
        .additional-price {
            font-size: 12px;
            color: var(--accent-green);
            margin-top: 2px;
        }
        
        .price-calculator {
            background: rgba(255, 215, 0, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.1);
            border-radius: var(--radius-md);
            padding: 12px;
            margin-top: 10px;
        }
        
        body.light-mode .price-calculator {
            background: rgba(255, 215, 0, 0.1);
        }
        
        .calculator-input {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .calculator-input label {
            color: var(--gray-300);
            font-size: 14px;
            flex: 1;
        }
        
        .calculator-input input {
            width: 60px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-sm);
            color: white;
            text-align: center;
            font-weight: 600;
        }
        
        body.light-mode .calculator-input input {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: var(--text-color);
        }
        
        .calculator-result {
            text-align: center;
            padding: 10px;
            background: rgba(76, 175, 80, 0.1);
            border-radius: var(--radius-sm);
            border: 1px solid rgba(76, 175, 80, 0.2);
        }
        
        .calculator-result span {
            font-weight: 800;
            color: #4CAF50;
            font-size: 18px;
        }
        
        /* === CART BUTTON === */
        .cart-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-yellow), #FF9800);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: var(--shadow-xl);
            z-index: 1000;
            transition: var(--transition-normal);
            border: 2px solid var(--card-bg);
        }
        
        .cart-button:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 10px 25px rgba(255, 152, 0, 0.4);
        }
        
        .cart-button i {
            font-size: 24px;
            color: var(--primary-black);
        }
        
        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(135deg, var(--accent-red), #FF5252);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            font-size: 12px;
            font-weight: 800;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid var(--card-bg);
            box-shadow: var(--shadow-sm);
        }
        
        /* === MODALS COMPACT === */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            z-index: 2000;
            animation: fadeIn 0.3s ease-out;
            padding: 15px;
        }
        
        .modal-overlay.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .app-modal {
            background: linear-gradient(135deg, #111111 0%, #1a1a1a 100%);
            border-radius: var(--radius-xl);
            width: 100%;
            max-width: 400px;
            max-height: 85vh;
            overflow-y: auto;
            animation: modalSlideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: var(--shadow-xl);
            position: relative;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        body.light-mode .app-modal {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 152, 0, 0.1));
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: 800;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modal-close {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-color);
            width: 35px;
            height: 35px;
            border-radius: var(--radius-full);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition-fast);
        }
        
        body.light-mode .modal-close {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }
        
        .modal-close:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: rgba(255, 215, 0, 0.4);
            transform: rotate(90deg);
        }
        
        .modal-body {
            padding: 20px;
        }
        
        /* === STORIES MODAL - Snapchat Style === */
        .stories-modal {
            max-width: 100% !important;
            height: 100vh !important;
            max-height: 100vh !important;
            border-radius: 0 !important;
            background: #000 !important;
        }
        
        .stories-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .story-header {
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(0, 0, 0, 0.7);
            position: relative;
            z-index: 10;
        }
        
        .story-shop-logo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid var(--primary-yellow);
        }
        
        .story-info h3 {
            color: white;
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .story-info p {
            color: var(--gray-400);
            font-size: 12px;
        }
        
        .story-content {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        .story-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: #000;
        }
        
        .story-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .story-progress {
            display: flex;
            gap: 5px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.7);
        }
        
        .story-progress-bar {
            flex: 1;
            height: 3px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-full);
            overflow: hidden;
        }
        
        .story-progress-fill {
            height: 100%;
            background: white;
            width: 0%;
            transition: width 0.1s linear;
        }
        
        .story-progress-fill.active {
            width: 100%;
            animation: storyProgress 10s linear forwards;
        }
        
        .story-nav {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            pointer-events: none;
        }
        
        .story-nav-btn {
            width: 50px;
            height: 100%;
            background: transparent;
            border: none;
            color: white;
            font-size: 30px;
            cursor: pointer;
            pointer-events: all;
            opacity: 0.7;
            transition: var(--transition-fast);
        }
        
        .story-nav-btn:hover {
            opacity: 1;
            transform: scale(1.2);
        }
        
        /* === CART MODAL === */
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        body.light-mode .cart-item {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .cart-item:last-child {
            border-bottom: none;
        }
        
        .cart-item-name {
            flex: 2;
            font-weight: 500;
            color: var(--text-color);
            font-size: 14px;
        }
        
        .cart-item-quantity {
            flex: 1;
            text-align: center;
            font-weight: 600;
            color: var(--text-color);
            font-size: 14px;
        }
        
        .cart-item-price {
            flex: 1;
            text-align: right;
            font-weight: 700;
            color: var(--primary-yellow);
            font-size: 14px;
        }
        
        .cart-item-remove {
            background: rgba(255, 82, 82, 0.2);
            color: #FF5252;
            border: 1px solid rgba(255, 82, 82, 0.3);
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            margin-left: 8px;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: var(--transition-fast);
        }
        
        .cart-item-remove:hover {
            background: rgba(255, 82, 82, 0.3);
        }
        
        .cart-summary {
            background: rgba(255,215,0,0.1);
            border-radius: var(--radius-lg);
            padding: 15px;
            margin: 15px 0;
        }
        
        body.light-mode .cart-summary {
            background: rgba(255, 215, 0, 0.15);
        }
        
        .cart-total {
            font-size: 24px;
            font-weight: 900;
            text-align: right;
            color: var(--primary-yellow);
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid rgba(255, 215, 0, 0.3);
        }
        
        .checkout-button {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent-orange), #FF5722);
            color: var(--primary-white);
            border: none;
            border-radius: var(--radius-lg);
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 20px;
            transition: var(--transition-normal);
        }
        
        .checkout-button:hover {
            background: linear-gradient(135deg, #FF5722, var(--accent-orange));
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(255, 87, 34, 0.4);
        }
        
        /* === PAYPAL BUTTON === */
        .paypal-button {
            width: 100%;
            margin-top: 15px;
            border-radius: var(--radius-md);
            overflow: hidden;
        }
        
        /* === CHECKOUT FORM COMPACT === */
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 6px;
            color: var(--gray-300);
            font-weight: 600;
            font-size: 13px;
        }
        
        .form-input, .form-textarea, .form-select, .form-datetime {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            color: var(--text-color);
            font-size: 14px;
            transition: var(--transition-fast);
        }
        
        body.light-mode .form-input,
        body.light-mode .form-textarea,
        body.light-mode .form-select,
        body.light-mode .form-datetime {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .form-input:focus, .form-textarea:focus, .form-select:focus, .form-datetime:focus {
            outline: none;
            border-color: var(--primary-yellow);
            background: rgba(255, 215, 0, 0.05);
        }
        
        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 20px;
            padding-right: 40px;
        }
        
        body.light-mode .form-select {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='black'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
        }
        
        .form-datetime {
            padding: 11px 12px;
        }
        
        .form-datetime::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }
        
        body.light-mode .form-datetime::-webkit-calendar-picker-indicator {
            filter: invert(0);
        }
        
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition-fast);
        }
        
        body.light-mode .radio-option {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .radio-option:hover {
            background: rgba(255, 215, 0, 0.1);
            border-color: rgba(255, 215, 0, 0.3);
        }
        
        .radio-option input[type="radio"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary-yellow);
        }
        
        .radio-option label {
            flex: 1;
            color: var(--text-color);
            font-weight: 500;
            cursor: pointer;
            font-size: 14px;
        }
        
        /* === PRODUCT DETAIL MODAL === */
        .product-detail-image {
            width: 100%;
            height: 200px;
            object-fit: contain;
            background: rgba(0,0,0,0.3);
            border-radius: var(--radius-md);
            margin-bottom: 15px;
        }
        
        .product-detail-name {
            font-size: 22px;
            font-weight: 800;
            color: var(--text-color);
            margin-bottom: 10px;
        }
        
        .product-detail-price {
            font-size: 28px;
            font-weight: 900;
            color: var(--primary-yellow);
            margin-bottom: 15px;
        }
        
        .product-detail-description {
            color: var(--gray-300);
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .product-detail-specs {
            background: rgba(255,255,255,0.05);
            border-radius: var(--radius-md);
            padding: 15px;
            margin-bottom: 20px;
        }
        
        body.light-mode .product-detail-specs {
            background: rgba(0, 0, 0, 0.05);
        }
        
        .product-detail-specs h4 {
            color: var(--text-color);
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .product-detail-specs ul {
            list-style: none;
            padding-left: 0;
        }
        
        .product-detail-specs li {
            color: var(--gray-300);
            font-size: 13px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* === MODAL COMPTE UTILISATEUR === */
        .account-modal {
            max-width: 350px !important;
        }
        
        .client-badge {
            display: inline-block;
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            padding: 4px 10px;
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 700;
            margin-left: 8px;
        }
        
        .client-info {
            background: rgba(255, 215, 0, 0.1);
            border-radius: var(--radius-lg);
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        body.light-mode .client-info {
            background: rgba(255, 215, 0, 0.15);
        }
        
        .client-name {
            font-size: 18px;
            font-weight: 800;
            color: var(--text-color);
            margin-bottom: 5px;
        }
        
        .client-details {
            color: var(--gray-300);
            font-size: 14px;
        }
        
        .order-history {
            margin-top: 20px;
        }
        
        .history-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-md);
            padding: 12px;
            margin-bottom: 10px;
            border-left: 3px solid var(--primary-yellow);
        }
        
        body.light-mode .history-item {
            background: rgba(0, 0, 0, 0.05);
        }
        
        .history-date {
            font-size: 12px;
            color: var(--gray-500);
            margin-bottom: 5px;
        }
        
        .history-total {
            font-weight: 700;
            color: var(--primary-yellow);
            font-size: 16px;
        }
        
        /* === ACCORDION STYLES === */
        .accordion {
            margin: 15px;
            border-radius: var(--radius-lg);
            overflow: hidden;
        }
        
        .accordion-item {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }
        
        body.light-mode .accordion-item {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .accordion-item:last-child {
            border-bottom: none;
        }
        
        .accordion-header {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: var(--transition-fast);
        }
        
        body.light-mode .accordion-header {
            background: rgba(0, 0, 0, 0.05);
        }
        
        .accordion-header:hover {
            background: rgba(255, 215, 0, 0.1);
        }
        
        .accordion-header.active {
            background: rgba(255, 215, 0, 0.2);
        }
        
        .accordion-title {
            font-weight: 600;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .accordion-icon {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .accordion-header.active .accordion-icon {
            transform: rotate(180deg);
        }
        
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 0 15px;
            background: rgba(0, 0, 0, 0.2);
        }
        
        body.light-mode .accordion-content {
            background: rgba(0, 0, 0, 0.03);
        }
        
        .accordion-content.open {
            max-height: 500px;
            padding: 15px;
        }
        
        /* === CALENDRIER RÃ‰SERVATION === */
        .calendar-container {
            height: 400px;
            margin-bottom: 15px;
        }
        
        .fc {
            font-size: 12px !important;
        }
        
        .fc .fc-toolbar-title {
            font-size: 16px !important;
        }
        
        .fc .fc-button {
            padding: 4px 8px !important;
            font-size: 12px !important;
        }
        
        .fc-daygrid-day-number {
            font-size: 12px !important;
        }
        
        .fc-event {
            cursor: pointer;
            padding: 2px 4px !important;
            font-size: 11px !important;
        }
        
        /* === CHAT WIDGET === */
        .chat-widget {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #25D366, #128C7E);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: var(--shadow-xl);
            z-index: 999;
            transition: var(--transition-normal);
            border: 2px solid var(--card-bg);
        }
        
        .chat-widget:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 25px rgba(37, 211, 102, 0.4);
        }
        
        .chat-widget i {
            font-size: 24px;
            color: white;
        }
        
        .chat-modal {
            position: fixed;
            bottom: 160px;
            right: 20px;
            width: 300px;
            max-height: 400px;
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            z-index: 1000;
            display: none;
            flex-direction: column;
            border: 1px solid rgba(255, 215, 0, 0.2);
            overflow: hidden;
        }
        
        .chat-modal.active {
            display: flex;
            animation: modalSlideUp 0.3s ease-out;
        }
        
        .chat-header {
            padding: 15px;
            background: linear-gradient(135deg, rgba(37, 211, 102, 0.2), rgba(18, 140, 126, 0.2));
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chat-header h3 {
            font-size: 16px;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .chat-body {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            max-height: 250px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .chat-message {
            max-width: 80%;
            padding: 8px 12px;
            border-radius: var(--radius-md);
            font-size: 13px;
            line-height: 1.4;
        }
        
        .chat-message.bot {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
        }
        
        .chat-message.user {
            align-self: flex-end;
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }
        
        .chat-input-container {
            padding: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 10px;
        }
        
        .chat-input {
            flex: 1;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-md);
            color: var(--text-color);
            font-size: 14px;
        }
        
        .chat-send {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            border: none;
            width: 40px;
            border-radius: var(--radius-md);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* === WIDGET MÃ‰TÃ‰O === */
        .weather-widget {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            border-radius: var(--radius-lg);
            padding: 15px;
            margin: 15px;
            color: white;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .weather-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .weather-temp {
            font-size: 32px;
            font-weight: 800;
        }
        
        .weather-desc {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .weather-details {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            opacity: 0.8;
        }
        
        /* === GALERIE PHOTOS === */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 10px;
        }
        
        .gallery-item {
            aspect-ratio: 1;
            border-radius: var(--radius-md);
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .gallery-item:hover {
            transform: scale(1.05);
        }
        
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* === SYSTÃˆME DE PARRAINAGE === */
        .referral-card {
            background: linear-gradient(135deg, rgba(156, 39, 176, 0.2), rgba(103, 58, 183, 0.2));
            border-radius: var(--radius-lg);
            padding: 15px;
            margin: 15px;
            border: 1px solid rgba(156, 39, 176, 0.3);
        }
        
        .referral-code {
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--radius-md);
            padding: 15px;
            text-align: center;
            margin: 10px 0;
            border: 2px dashed rgba(255, 255, 255, 0.3);
        }
        
        .referral-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: 800;
            color: var(--primary-yellow);
        }
        
        .stat-label {
            font-size: 11px;
            color: var(--gray-400);
        }
        
        /* === TOGGLE LANGUE === */
        .lang-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-color);
            padding: 8px 12px;
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        
        /* === TOGGLE MODE NUIT/JOUR === */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        
        /* === NOTIFICATIONS PUSH === */
        .notification-bell {
            position: fixed;
            bottom: 160px;
            left: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #FF9800, #FF5722);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: var(--shadow-xl);
            z-index: 999;
            transition: var(--transition-normal);
            border: 2px solid var(--card-bg);
        }
        
        .notification-bell:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 25px rgba(255, 152, 0, 0.4);
        }
        
        .notification-bell i {
            font-size: 24px;
            color: white;
        }
        
        .notification-bell.has-notification::after {
            content: '';
            position: absolute;
            top: 5px;
            right: 5px;
            width: 12px;
            height: 12px;
            background: #FF5252;
            border-radius: 50%;
            border: 2px solid var(--card-bg);
        }
        
        /* === FIDÃ‰LITÃ‰ POINTS === */
        .loyalty-card {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 152, 0, 0.2));
            border-radius: var(--radius-lg);
            padding: 15px;
            margin: 15px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        .loyalty-progress {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-full);
            overflow: hidden;
            margin: 10px 0;
        }
        
        .loyalty-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #FFD700, #FF9800);
            border-radius: var(--radius-full);
            transition: width 0.3s;
        }
        
        .loyalty-stats {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--gray-400);
        }
        
        /* === WHATSAPP INTEGRATION === */
        .whatsapp-float {
            position: fixed;
            bottom: 230px;
            left: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #25D366, #128C7E);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: var(--shadow-xl);
            z-index: 999;
            transition: var(--transition-normal);
            border: 2px solid var(--card-bg);
            text-decoration: none;
        }
        
        .whatsapp-float:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 25px rgba(37, 211, 102, 0.4);
        }
        
        .whatsapp-float i {
            font-size: 24px;
            color: white;
        }
        
        /* === ANIMATIONS === */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        @keyframes pulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 
                    0 4px 8px rgba(255, 215, 0, 0.3),
                    0 0 0 2px rgba(0,0,0,0.8);
            }
            50% { 
                transform: scale(1.1);
                box-shadow: 
                    0 4px 12px rgba(255, 215, 0, 0.5),
                    0 0 0 2px rgba(0,0,0,0.8),
                    0 0 15px rgba(255, 215, 0, 0.3);
            }
        }
        
        @keyframes storyProgress {
            from { width: 0%; }
            to { width: 100%; }
        }
        
        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translate(-50%, -100%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }
        
        @keyframes slideOutUp {
            from {
                opacity: 1;
                transform: translate(-50%, 0);
            }
            to {
                opacity: 0;
                transform: translate(-50%, -100%);
            }
        }
        
        /* === RESPONSIVE DESIGN === */
        @media (max-width: 480px) {
            .app-header {
                padding: 15px;
            }
            
            .logo-wrapper {
                width: 60px;
                height: 60px;
            }
            
            .header-title {
                font-size: 22px;
            }
            
            .menu-button {
                right: 55px;
                width: 35px;
                height: 35px;
            }
            
            .account-button {
                width: 35px;
                height: 35px;
                top: 10px;
                right: 10px;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .product-image-container {
                height: 160px;
            }
            
            .map-container {
                height: 220px;
            }
            
            .cart-button, .chat-widget, .notification-bell {
                width: 55px;
                height: 55px;
            }
            
            .cart-button {
                bottom: 15px;
                right: 15px;
            }
            
            .chat-widget {
                bottom: 85px;
                right: 15px;
            }
            
            .notification-bell {
                bottom: 155px;
                left: 15px;
            }
            
            .cart-button i, .chat-widget i, .notification-bell i {
                font-size: 22px;
            }
            
            .logo-star {
                width: 26px;
                height: 26px;
                bottom: -3px;
                right: -3px;
            }
            
            .logo-star::before {
                font-size: 14px;
            }
            
            .chat-modal {
                width: 280px;
                right: 10px;
            }
            
            .theme-toggle, .lang-toggle {
                top: 15px;
                padding: 6px 10px;
            }
            
            .theme-toggle {
                right: 15px;
            }
            
            .lang-toggle {
                left: 15px;
            }
        }
        
        @media (max-width: 360px) {
            .header-title {
                font-size: 20px;
            }
            
            .shop-details {
                grid-template-columns: 1fr;
            }
            
            .product-name {
                font-size: 14px;
                height: 40px;
            }
            
            .gallery-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* === UTILITY CLASSES === */
        .hidden {
            display: none !important;
        }
        
        .visible {
            display: block !important;
        }
        
        .text-center {
            text-align: center;
        }
        
        .mt-10 {
            margin-top: 10px;
        }
        
        .mt-15 {
            margin-top: 15px;
        }
        
        .mt-20 {
            margin-top: 20px;
        }
        
        .mb-10 {
            margin-bottom: 10px;
        }
        
        .mb-15 {
            margin-bottom: 15px;
        }
        
        /* === SCROLLBAR STYLING === */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-full);
        }
        
        body.light-mode ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(var(--primary-yellow), #FF9800);
            border-radius: var(--radius-full);
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(#FF9800, var(--primary-yellow));
        }
    </style>
</head>
<body>
    <!-- Main Container -->
    <div class="main-container">
        <div class="profile-container">
            
            <!-- App Header avec bouton compte ET bouton menu -->
            <div class="app-header">
                <div class="logo-wrapper">
                    <img src="https://mcusercontent.com/40a9f1a77d46874eba2309d88/images/89a59702-cad3-dfb7-580d-22fb843f8d3f.jpeg" 
                         alt="H.D.S SHOP Logo" 
                         class="logo-image" 
                         id="logoImage">
                    <div class="logo-star"></div>
                </div>
                
                <div class="header-content">
                    <div class="header-title">H.D.S SHOP</div>
                    <div class="header-subtitle">ORGANISATION Ã‰VÃ‰NEMENTS & BOUTIQUE PREMIUM</div>
                    <div class="header-tag">SERVICE 24H/24</div>
                </div>
                
                <!-- Bouton menu principal -->
                <div class="menu-button" id="menuButton" onclick="toggleMenu()">
                    <i class="fas fa-bars"></i>
                </div>
                
                <!-- Bouton compte utilisateur -->
                <div class="account-button disconnected" id="accountButton" onclick="openAccountModal()">
                    <i class="fas fa-user"></i>
                </div>
            </div>
            
            <!-- Navigation rapide MIS Ã€ JOUR -->
            <div class="quick-nav">
                <button class="quick-nav-btn" onclick="showProductsSection()">
                    <i class="fas fa-shopping-bag"></i>
                    <span>Produits</span>
                </button>
                <button class="quick-nav-btn" onclick="showAccessoriesSection()">
                    <i class="fas fa-fire"></i>
                    <span>Populaires</span>
                </button>
                <button class="quick-nav-btn" onclick="showEventsSection()">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Ã‰vÃ©nements</span>
                </button>
                <button class="quick-nav-btn" onclick="scrollToSection('tracker')">
                    <i class="fas fa-shipping-fast"></i>
                    <span>Suivi</span>
                </button>
                <button class="quick-nav-btn" onclick="showInfoSection()">
                    <i class="fas fa-info-circle"></i>
                    <span>Infos</span>
                </button>
            </div>
            
            <!-- Status Bar -->
            <div class="status-bar" id="statusText">
                <div class="status-text">ðŸŽ‰ Organisation Ã‰vÃ©nements Marseille</div>
            </div>
            
            <!-- Section PRODUITS (affichÃ©e par dÃ©faut) -->
            <div class="app-card" id="productsSection">
                <div class="card-title">
                    <i class="fas fa-shopping-bag"></i>
                    Produits
                </div>
                
                <div class="category-tabs" id="categoryTabs">
                    <div class="category-tab active" data-category="all">Tous</div>
                    <div class="category-tab" data-category="repas">ðŸ½ï¸ Repas</div>
                    <div class="category-tab" data-category="catering">ðŸ‘¨â€ðŸ³ Catering</div>
                    <div class="category-tab" data-category="boissons">ðŸ¥¤ Boissons</div>
                    <div class="category-tab" data-category="alcools">ðŸ¾ Alcools</div>
                    <div class="category-tab" data-category="accessoires">ðŸ”Œ Accessoires</div>
                </div>
                
                <div class="products-grid" id="productsGrid">
                    <!-- Produits normaux chargÃ©s dynamiquement -->
                </div>
            </div>
            
            <!-- Section ACCESSOIRES POPULAIRES -->
            <div class="app-card" id="accessoriesSection" style="display: none;">
                <div class="card-title">
                    <i class="fas fa-fire"></i>
                    Produits Populaires
                </div>
                
                <div class="products-grid" id="accessoriesGrid">
                    <!-- Produits populaires chargÃ©s dynamiquement -->
                </div>
            </div>
            
            <!-- Section Ã‰VÃ‰NEMENTS -->
            <div class="app-card" id="eventsSection" style="display: none;">
                <div class="card-title">
                    <i class="fas fa-calendar-alt"></i>
                    Nos Ã‰vÃ©nements
                </div>
                
                <!-- Galerie d'Ã©vÃ©nements passÃ©s -->
                <div class="gallery-grid" id="eventGallery">
                    <!-- Images chargÃ©es dynamiquement -->
                </div>
                
                <!-- Liste des Ã©vÃ©nements disponibles -->
                <div class="products-grid" id="eventsGrid">
                    <!-- Ã‰vÃ©nements chargÃ©s dynamiquement -->
                </div>
            </div>
            
            <!-- Section INFOS (regroupement des dÃ©tails) -->
            <div class="app-card" id="infoSection" style="display: none;">
                <div class="card-title">
                    <i class="fas fa-info-circle"></i>
                    Informations Boutique
                </div>
                
                <!-- DÃ©tails de la boutique -->
                <div class="shop-details">
                    <div class="detail-item">
                        <div class="detail-icon">â­</div>
                        <div class="detail-text">Ã‰valuations</div>
                        <div class="detail-value">4.9/5</div>
                    </div>
                    
                    <div class="detail-item">
                        <div class="detail-icon">ðŸ‘¥</div>
                        <div class="detail-text">Ã‰vÃ©nements</div>
                        <div class="detail-value">500+</div>
                    </div>
                    
                    <div class="detail-item">
                        <div class="detail-icon">ðŸšš</div>
                        <div class="detail-text">Livraison</div>
                        <div class="detail-value">Gratuite Ã  50â‚¬</div>
                    </div>
                    
                    <div class="detail-item">
                        <div class="detail-icon">ðŸ’°</div>
                        <div class="detail-text">Frais min</div>
                        <div class="detail-value">2â‚¬ - 8â‚¬</div>
                    </div>
                </div>
                
                <!-- AccordÃ©on FAQ regroupÃ© -->
                <div class="accordion" id="faqAccordion">
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">
                                <i class="fas fa-question-circle"></i>
                                Comment rÃ©server un Ã©vÃ©nement ?
                            </div>
                            <div class="accordion-icon">â–¼</div>
                        </div>
                        <div class="accordion-content">
                            <p style="color: var(--gray-300); font-size: 13px; line-height: 1.5;">
                                1. SÃ©lectionnez le type d'Ã©vÃ©nement dans les produits<br>
                                2. Choisissez la date dans le calendrier de rÃ©servation<br>
                                3. Configurez le nombre de personnes et options<br>
                                4. Validez votre rÃ©servation en ligne
                            </p>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">
                                <i class="fas fa-truck"></i>
                                Zones et frais de livraison
                            </div>
                            <div class="accordion-icon">â–¼</div>
                        </div>
                        <div class="accordion-content">
                            <p style="color: var(--gray-300); font-size: 13px; line-height: 1.5;">
                                <strong>Centre-ville (0-2km):</strong> Livraison gratuite Ã  partir de 50â‚¬<br>
                                <strong>Zone proche (2-5km):</strong> 2-3â‚¬ de frais<br>
                                <strong>Zone moyenne (5-10km):</strong> 4-5â‚¬ de frais<br>
                                <strong>Zone Ã©loignÃ©e (10+ km):</strong> 6-8â‚¬ de frais<br>
                                <em>Pour les Ã©vÃ©nements, frais supplÃ©mentaires selon la taille.</em>
                            </p>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">
                                <i class="fas fa-gift"></i>
                                Programme de fidÃ©litÃ©
                            </div>
                            <div class="accordion-icon">â–¼</div>
                        </div>
                        <div class="accordion-content">
                            <p style="color: var(--gray-300); font-size: 13px; line-height: 1.5;">
                                â€¢ 1 point pour chaque euro dÃ©pensÃ©<br>
                                â€¢ 100 points = 10â‚¬ de rÃ©duction<br>
                                â€¢ Offres exclusives pour les membres<br>
                                â€¢ Parrainage : 10â‚¬ pour vous et votre ami<br>
                                â€¢ Suivi des points dans votre compte
                            </p>
                        </div>
                    </div>
                </div>
                
                <!-- Carte des zones de livraison -->
                <div class="card-title" style="margin-top: 20px;">
                    <i class="fas fa-map-marker-alt"></i>
                    Carte des zones
                </div>
                
                <!-- Bouton de localisation -->
                <button class="location-button" id="locateMeButton" onclick="locateUser()">
                    <i class="fas fa-location-dot"></i>
                    Me localiser
                </button>
                
                <!-- Affichage de distance -->
                <div class="distance-display" id="distanceDisplay">
                    <i class="fas fa-ruler"></i>
                    <span id="distanceText">Distance en cours de calcul...</span>
                </div>
                
                <div class="map-container" id="deliveryMap"></div>
                
                <div class="map-legend">
                    <div class="legend-item">
                        <div class="legend-dot legend-free"></div>
                        <span>Gratuite</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot legend-1eur"></div>
                        <span>2-3â‚¬</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot legend-3eur"></div>
                        <span>4-5â‚¬</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot legend-5eur"></div>
                        <span>6-8â‚¬</span>
                    </div>
                </div>
            </div>
            
            <!-- Section SUIVI avec barre de progression -->
            <div class="app-card" id="trackerSection">
                <div class="card-title">
                    <i class="fas fa-shipping-fast"></i>
                    Suivi en direct
                </div>
                
                <div class="tracker-container">
                    <div class="driver-avatar">M</div>
                    <div class="tracker-info">
                        <div class="tracker-status" id="deliveryStatus">En attente</div>
                        <div class="driver-name">Mohamed - Livreur #HDS23</div>
                        <div class="driver-eta" id="driverETA">ðŸ“ PrÃªt pour livraison</div>
                    </div>
                </div>
                
                <!-- Barre de progression pour le suivi -->
                <div class="progress-tracker" id="progressTracker" style="display: none;">
                    <div class="progress-header">
                        <div class="progress-title">Progression de la livraison</div>
                        <div class="progress-percentage" id="progressPercentage">0%</div>
                    </div>
                    
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                    
                    <div class="progress-steps">
                        <div class="progress-step">
                            <div class="step-icon completed" id="step1">1</div>
                            <div class="step-label completed">Commande</div>
                        </div>
                        <div class="progress-step">
                            <div class="step-icon active" id="step2">2</div>
                            <div class="step-label active">PrÃ©paration</div>
                        </div>
                        <div class="progress-step">
                            <div class="step-icon" id="step3">3</div>
                            <div class="step-label">En route</div>
                        </div>
                        <div class="progress-step">
                            <div class="step-icon" id="step4">4</div>
                            <div class="step-label">LivrÃ©</div>
                        </div>
                    </div>
                    
                    <div class="progress-time" id="progressTime">
                        Temps estimÃ©: <span id="estimatedTime">--</span>
                    </div>
                </div>
                
                <button class="checkout-button mt-15" id="followDeliveryButton" onclick="openDeliveryTrackerModal()" style="display: none;">
                    <i class="fas fa-map-marker-alt"></i>
                    Suivre ma livraison
                </button>
                
                <button class="checkout-button mt-10" id="startTrackerButton" onclick="startRealisticDeliveryTracker()" style="display: none;">
                    <i class="fas fa-play"></i>
                    DÃ©marrer le suivi
                </button>
            </div>
            
            <!-- Footer -->
            <div style="padding: 20px; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
                <div style="font-size: 11px; color: var(--gray-500); margin-bottom: 5px;">
                    Â© 2024 H.D.S SHOP - Tous droits rÃ©servÃ©s
                </div>
                <div style="font-size: 10px; color: var(--gray-600);">
                    Marseille â€¢ Organisation Ã©vÃ©nements â€¢ Paiement sÃ©curisÃ©
                </div>
                <div style="margin-top: 10px;">
                    <img src="https://www.paypalobjects.com/webstatic/mktg/logo/pp_cc_mark_37x23.jpg" 
                         alt="PayPal" 
                         style="height: 20px; margin: 0 5px;">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/2560px-Visa_Inc._logo.svg.png" 
                         alt="Visa" 
                         style="height: 15px; margin: 0 5px;">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/1280px-Mastercard-logo.svg.png" 
                         alt="Mastercard" 
                         style="height: 15px; margin: 0 5px;">
                </div>
            </div>
        </div>
    </div>
    
    <!-- Menu vertical -->
    <div class="vertical-menu" id="verticalMenu">
        <div class="menu-header">
            <h3><i class="fas fa-cog"></i> Options</h3>
            <button class="menu-close" onclick="toggleMenu()">Ã—</button>
        </div>
        <div class="menu-items">
            <!-- Widget MÃ©tÃ©o dans le menu -->
            <div class="menu-item" onclick="showWeatherInfo()">
                <i class="fas fa-sun"></i>
                <div class="menu-item-text">MÃ©tÃ©o</div>
                <div class="menu-item-value" id="menuWeatherTemp">28Â°C</div>
            </div>
            
            <!-- Carte FidÃ©litÃ© dans le menu -->
            <div class="menu-item" onclick="showLoyaltyInfo()">
                <i class="fas fa-crown"></i>
                <div class="menu-item-text">Carte FidÃ©litÃ©</div>
                <div class="menu-item-value" id="menuLoyaltyPoints">0 pts</div>
            </div>
            
            <!-- SystÃ¨me de parrainage dans le menu -->
            <div class="menu-item" onclick="showReferralInfo()">
                <i class="fas fa-user-friends"></i>
                <div class="menu-item-text">Parrainage</div>
                <div class="menu-item-value" id="menuReferralEarnings">0â‚¬</div>
            </div>
            
            <!-- SÃ©parateur -->
            <div style="height: 1px; background: rgba(255,255,255,0.1); margin: 10px 0;"></div>
            
            <!-- Autres options du menu -->
            <div class="menu-item" onclick="toggleLanguage()">
                <i class="fas fa-globe"></i>
                <div class="menu-item-text">Langue</div>
                <div class="menu-item-value" id="menuLang">FR</div>
            </div>
            <div class="menu-item" onclick="toggleTheme()">
                <i class="fas fa-moon" id="menuThemeIcon"></i>
                <div class="menu-item-text">Mode sombre</div>
                <div class="menu-item-value" id="menuTheme">ON</div>
            </div>
            <div class="menu-item" onclick="window.open('https://wa.me/33744892782?text=Bonjour%20H.D.S%20SHOP%20!%20Je%20souhaite%20r%C3%A9server%20un%20%C3%A9v%C3%A9nement.', '_blank')">
                <i class="fab fa-whatsapp"></i>
                <div class="menu-item-text">WhatsApp</div>
                <div class="menu-item-value">ðŸ’¬</div>
            </div>
            <div class="menu-item" onclick="showNotifications()">
                <i class="fas fa-bell"></i>
                <div class="menu-item-text">Notifications</div>
                <div class="menu-item-value" id="menuNotificationCount">0</div>
            </div>
            <div class="menu-item" onclick="toggleChat()">
                <i class="fas fa-comments"></i>
                <div class="menu-item-text">Messages</div>
                <div class="menu-item-value">ðŸ’­</div>
            </div>
            <div class="menu-item" onclick="openAccountModal()">
                <i class="fas fa-user"></i>
                <div class="menu-item-text">Mon compte</div>
                <div class="menu-item-value">ðŸ‘¤</div>
            </div>
            <div class="menu-item" onclick="openCart()">
                <i class="fas fa-shopping-cart"></i>
                <div class="menu-item-text">Panier</div>
                <div class="menu-item-value" id="menuCartCount">0</div>
            </div>
            <div class="menu-item" onclick="openStories()">
                <i class="fas fa-play-circle"></i>
                <div class="menu-item-text">Stories</div>
                <div class="menu-item-value">ðŸ“¹ 5</div>
            </div>
            <div class="menu-item" onclick="locateUser()">
                <i class="fas fa-location-dot"></i>
                <div class="menu-item-text">Me localiser</div>
                <div class="menu-item-value">ðŸ“</div>
            </div>
            <div class="menu-item" onclick="showEventsSection()">
                <i class="fas fa-calendar-alt"></i>
                <div class="menu-item-text">Ã‰vÃ©nements</div>
                <div class="menu-item-value">ðŸŽŠ</div>
            </div>
            <div class="menu-item" onclick="showAccessoriesSection()">
                <i class="fas fa-fire"></i>
                <div class="menu-item-text">Populaires</div>
                <div class="menu-item-value">ðŸ”¥</div>
            </div>
        </div>
    </div>
    
    <!-- Cart Button -->
    <div class="cart-button" id="openCartButton">
        <i class="fas fa-shopping-cart"></i>
        <div class="cart-count" id="cartCount">0</div>
    </div>
    

    <!-- Lang Toggle -->
    <div class="lang-toggle" onclick="toggleLanguage()">
        <i class="fas fa-globe"></i>
        <span id="langText">FR</span>
    </div>
    
    <!-- Chat Modal -->
    <div class="chat-modal" id="chatModal">
        <div class="chat-header">
            <h3><i class="fas fa-headset"></i> Support H.D.S</h3>
            <button class="modal-close" onclick="toggleChat()">Ã—</button>
        </div>
        <div class="chat-body" id="chatBody">
            <div class="chat-message bot">
                Bonjour ! ðŸ‘‹ Comment puis-je vous aider aujourd'hui ?
            </div>
        </div>
        <div class="chat-input-container">
            <input type="text" class="chat-input" id="chatInput" placeholder="Tapez votre message..." onkeypress="handleChatInput(event)">
            <button class="chat-send" onclick="sendChatMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
    
    <!-- Cart Modal -->
    <div class="modal-overlay" id="cartModalOverlay">
        <div class="app-modal">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-shopping-cart"></i>
                    Mon Panier
                </div>
                <button class="modal-close" onclick="closeCart()">Ã—</button>
            </div>
            <div class="modal-body">
                <div id="cartItems"></div>
                
                <div class="cart-summary">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span style="color: var(--gray-400); font-size: 14px;">Sous-total</span>
                        <span style="font-weight: 600; color: white; font-size: 14px;" id="subtotal">0â‚¬</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span style="color: var(--gray-400); font-size: 14px;">RÃ©duction client</span>
                        <span style="font-weight: 600; color: #4CAF50; font-size: 14px;" id="clientDiscount">0â‚¬</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--gray-400); font-size: 14px;">Livraison</span>
                        <span style="font-weight: 600; color: #4CAF50; font-size: 14px;" id="deliveryCost">Gratuit</span>
                    </div>
                </div>
                
                <div class="cart-total" id="cartTotal">Total : 0â‚¬</div>
                
                <button class="checkout-button" onclick="checkout()">
                    <i class="fas fa-lock"></i>
                    Commander maintenant
                </button>
            </div>
        </div>
    </div>
    
    <!-- Checkout Modal avec sections sÃ©parÃ©es -->
    <div class="modal-overlay" id="checkoutModalOverlay">
        <div class="app-modal">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-lock"></i>
                    Finaliser la commande
                </div>
                <button class="modal-close" onclick="closeCheckout()">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="checkoutForm" action="https://formspree.io/f/xkovrwjy" method="POST">
                    <!-- Section formulaire normal (affichÃ© par dÃ©faut) -->
                    <div id="normalFormSection">
                        <div class="form-group">
                            <label class="form-label">Informations personnelles</label>
                            <input type="text" name="nom" class="form-input" placeholder="Nom complet" required>
                            <input type="tel" name="telephone" class="form-input mt-10" placeholder="TÃ©lÃ©phone" required>
                            <textarea name="adresse" class="form-textarea mt-10" placeholder="Adresse complÃ¨te Ã  Marseille" required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">MÃ©thode de paiement</label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="cash" name="paiement" value="EspÃ¨ces" checked>
                                    <label for="cash">EspÃ¨ces Ã  la livraison</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="card" name="paiement" value="Carte Bancaire">
                                    <label for="card">Carte bancaire (PayPal)</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Section PayPal -->
                        <div id="paypal-button-container" style="display: none; margin-top: 15px;"></div>
                        
                        <div class="form-group">
                            <label class="form-label">Instructions spÃ©ciales</label>
                            <textarea name="instructions" class="form-textarea" placeholder="PrÃ©fÃ©rences, dÃ©tails de livraison..."></textarea>
                        </div>
                    </div>
                    
                    <!-- Section formulaire Ã©vÃ©nement (cachÃ© par dÃ©faut) -->
                    <div id="eventFormSection" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Informations personnelles</label>
                            <input type="text" name="nom_evenement" class="form-input" placeholder="Nom complet" required>
                            <input type="tel" name="telephone_evenement" class="form-input mt-10" placeholder="TÃ©lÃ©phone" required>
                            <textarea name="adresse_evenement" class="form-textarea mt-10" placeholder="Adresse complÃ¨te de l'Ã©vÃ©nement" required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Type d'Ã©vÃ©nement</label>
                            <select name="type_evenement" class="form-select" onchange="updateEventPricing()">
                                <option value="">SÃ©lectionnez un type</option>
                                <option value="anniversaire_enfant">ðŸŽ‚ Anniversaire Enfant (5-12 ans)</option>
                                <option value="anniversaire_ado">ðŸŽ® Anniversaire Ado (13-17 ans)</option>
                                <option value="anniversaire_adultes">ðŸ¥³ Anniversaire Adultes</option>
                                <option value="soiree_entreprise">ðŸ’¼ SoirÃ©e Entreprise</option>
                                <option value="mariage">ðŸ’ Mariage</option>
                                <option value="soiree_privee">ðŸŽ‰ SoirÃ©e PrivÃ©e</option>
                                <option value="baby_shower">ðŸ‘¶ Baby Shower</option>
                                <option value="evenement_pro">ðŸ¢ Ã‰vÃ©nement Professionnel</option>
                            </select>
                        </div>
                        
                        <!-- Tableau de prix dynamique pour Ã©vÃ©nements -->
                        <div class="pricing-table" id="eventPricingTable" style="display: none;">
                            <h4><i class="fas fa-calculator"></i> Tableau des prix</h4>
                            <div class="pricing-option">
                                <div class="person-count">
                                    <i class="fas fa-user"></i>
                                    <span>1-10 personnes</span>
                                </div>
                                <div>
                                    <div class="event-price">150â‚¬</div>
                                    <div class="additional-price">Base</div>
                                </div>
                            </div>
                            <div class="pricing-option">
                                <div class="person-count">
                                    <i class="fas fa-user-friends"></i>
                                    <span>11-20 personnes</span>
                                </div>
                                <div>
                                    <div class="event-price">250â‚¬</div>
                                    <div class="additional-price">+10â‚¬/pers</div>
                                </div>
                            </div>
                            <div class="pricing-option">
                                <div class="person-count">
                                    <i class="fas fa-users"></i>
                                    <span>21-30 personnes</span>
                                </div>
                                <div>
                                    <div class="event-price">350â‚¬</div>
                                    <div class="additional-price">+10â‚¬/pers</div>
                                </div>
                            </div>
                            <div class="pricing-option">
                                <div class="person-count">
                                    <i class="fas fa-crowd"></i>
                                    <span>31-50 personnes</span>
                                </div>
                                <div>
                                    <div class="event-price">500â‚¬</div>
                                    <div class="additional-price">+12â‚¬/pers</div>
                                </div>
                            </div>
                            
                            <!-- Calculateur de prix -->
                            <div class="price-calculator">
                                <div class="calculator-input">
                                    <label>Nombre de personnes :</label>
                                    <input type="number" id="personCount" min="1" max="100" value="10" onchange="calculateEventPrice()">
                                </div>
                                <div class="calculator-result">
                                    Prix estimÃ© : <span id="estimatedPrice">150â‚¬</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Calendrier de rÃ©servation -->
                        <div class="form-group">
                            <label class="form-label">Date de l'Ã©vÃ©nement</label>
                            <input type="date" name="date_evenement" class="form-datetime" min="<?php echo date('Y-m-d'); ?>" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Heure de l'Ã©vÃ©nement</label>
                            <select name="heure_evenement" class="form-select" required>
                                <option value="">SÃ©lectionnez une heure</option>
                                <option value="10:00">10:00 - Matin</option>
                                <option value="12:00">12:00 - DÃ©jeuner</option>
                                <option value="15:00">15:00 - AprÃ¨s-midi</option>
                                <option value="18:00">18:00 - SoirÃ©e</option>
                                <option value="20:00">20:00 - Nuit</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Nombre de personnes</label>
                            <select name="nombre_personnes" class="form-select" onchange="calculateEventPrice()" required>
                                <option value="1-10">1-10 personnes</option>
                                <option value="11-20">11-20 personnes</option>
                                <option value="21-30">21-30 personnes</option>
                                <option value="31-50">31-50 personnes</option>
                                <option value="51-100">51-100 personnes</option>
                                <option value="100+">100+ personnes</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">MÃ©thode de paiement</label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="cash_event" name="paiement_evenement" value="EspÃ¨ces" checked>
                                    <label for="cash_event">EspÃ¨ces Ã  la livraison</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="card_event" name="paiement_evenement" value="Carte Bancaire">
                                    <label for="card_event">Carte bancaire (PayPal)</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Section PayPal pour Ã©vÃ©nements -->
                        <div id="paypal-event-button-container" style="display: none; margin-top: 15px;"></div>
                        
                        <div class="form-group">
                            <label class="form-label">Instructions spÃ©ciales pour l'Ã©vÃ©nement</label>
                            <textarea name="instructions_evenement" class="form-textarea" placeholder="ThÃ¨me de l'Ã©vÃ©nement, allergies alimentaires, prÃ©fÃ©rences, dÃ©corations spÃ©ciales..."></textarea>
                        </div>
                    </div>
                    
                    <!-- Champs cachÃ©s pour les dÃ©tails de commande -->
                    <input type="hidden" name="details_commande" id="orderDetails">
                    <input type="hidden" name="code_confirmation" id="confirmationCodeInput">
                    <input type="hidden" name="total_commande" id="totalOrderInput">
                    <input type="hidden" name="frais_livraison" id="deliveryFeeInput">
                    <input type="hidden" name="nombre_articles" id="itemCountInput">
                    <input type="hidden" name="reduction_client" id="clientDiscountInput">
                    <input type="hidden" name="type_commande" id="orderTypeInput">
                    
                    <!-- Protection Formspree -->
                    <input type="text" name="_gotcha" style="display:none">
                    <input type="hidden" name="_subject" value="Nouvelle commande H.D.S SHOP - Ã‰vÃ©nement Marseille">
                    <input type="hidden" name="_template" value="table">
                    <input type="hidden" name="_language" value="fr">
                    
                    <button type="button" class="checkout-button" onclick="validateAndSubmitOrder()">
                        <i class="fas fa-check-circle"></i>
                        Confirmer la commande
                    </button>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="confirmationModalOverlay">
        <div class="app-modal">
            <div class="modal-header" style="background: linear-gradient(135deg, rgba(76,175,80,0.2), rgba(46,125,50,0.2));">
                <div class="modal-title">
                    <i class="fas fa-check-circle"></i>
                    Commande confirmÃ©e
                </div>
                <button class="modal-close" onclick="closeConfirmation()">Ã—</button>
            </div>
            <div class="modal-body" style="text-align: center;">
                <div style="font-size: 60px; margin-bottom: 15px;">ðŸŽ‰</div>
                <div style="font-size: 22px; font-weight: 800; color: white; margin-bottom: 10px;">Code de confirmation</div>
                
                <div style="background: rgba(255,215,0,0.1); border: 2px dashed var(--primary-yellow); border-radius: var(--radius-lg); padding: 20px; margin: 20px 0;">
                    <div style="font-size: 14px; color: var(--gray-400); margin-bottom: 8px;">MONTRER AU LIVREUR</div>
                    <div style="font-size: 36px; font-weight: 800; color: var(--primary-yellow); letter-spacing: 5px; margin-bottom: 10px;" id="confirmationCode">HDS-8542</div>
                    <div style="font-size: 12px; color: var(--gray-400);">Capture d'Ã©cran recommandÃ©e</div>
                </div>
                
                <div style="display: grid; gap: 12px; margin-bottom: 20px;">
                    <div style="text-align: left; background: rgba(255,255,255,0.05); padding: 12px; border-radius: var(--radius-md);">
                        <div style="font-size: 11px; color: var(--gray-400); margin-bottom: 4px;">Temps estimÃ©</div>
                        <div style="font-weight: 700; color: white;" id="deliveryTimeEstimate">30-45 minutes</div>
                    </div>
                    <div style="text-align: left; background: rgba(255,255,255,0.05); padding: 12px; border-radius: var(--radius-md);">
                        <div style="font-size: 11px; color: var(--gray-400); margin-bottom: 4px;">Livreur</div>
                        <div style="font-weight: 700; color: white;" id="deliveryDriver">Mohamed #HDS23</div>
                    </div>
                </div>
                
                <p style="color: var(--gray-400); font-size: 13px; line-height: 1.5; margin-bottom: 20px;">
                    Montrez votre code au livreur et prÃ©parez le paiement.
                </p>
                
                <button class="checkout-button" onclick="validateAndCloseConfirmation()">
                    <i class="fas fa-check"></i>
                    Valider la commande
                </button>
                
                <button class="checkout-button mt-10" style="background: rgba(255,255,255,0.1);" onclick="startRealisticDeliveryTracker()">
                    <i class="fas fa-shipping-fast"></i>
                    Suivre la livraison
                </button>
            </div>
        </div>
    </div>
    
    <!-- Stories Snapchat Style Modal - MIS Ã€ JOUR AVEC VOS VIDÃ‰OS -->
    <div class="modal-overlay" id="storiesModalOverlay">
        <div class="app-modal stories-modal">
            <div class="stories-container">
                <!-- Header des stories -->
                <div class="story-header">
                    <img src="https://mcusercontent.com/40a9f1a77d46874eba2309d88/images/89a59702-cad3-dfb7-580d-22fb843f8d3f.jpeg" 
                         alt="H.D.S SHOP" 
                         class="story-shop-logo">
                    <div class="story-info">
                        <h3>H.D.S SHOP Stories</h3>
                        <p>Ã‰vÃ©nements Marseille â€¢ 5 nouvelles stories</p>
                    </div>
                    <button class="modal-close" onclick="closeStories()" style="margin-left: auto;">Ã—</button>
                </div>
                
                <!-- Barre de progression -->
                <div class="story-progress">
                    <div class="story-progress-bar">
                        <div class="story-progress-fill" id="storyProgress1"></div>
                    </div>
                    <div class="story-progress-bar">
                        <div class="story-progress-fill" id="storyProgress2"></div>
                    </div>
                    <div class="story-progress-bar">
                        <div class="story-progress-fill" id="storyProgress3"></div>
                    </div>
                    <div class="story-progress-bar">
                        <div class="story-progress-fill" id="storyProgress4"></div>
                    </div>
                    <div class="story-progress-bar">
                        <div class="story-progress-fill" id="storyProgress5"></div>
                    </div>
                </div>
                
                <!-- Contenu des stories - VOS 5 VIDÃ‰OS INTÃ‰GRÃ‰ES -->
                <div class="story-content" id="storySlides">
                    <!-- Story 1 - Votre premiÃ¨re vidÃ©o -->
                    <div class="story-slide active" id="storySlide1">
                        <video controls autoplay muted loop class="story-video">
                            <source src="https://files.catbox.moe/w1ic5k.mp4" type="video/mp4">
                            Votre navigateur ne supporte pas la lecture de vidÃ©os.
                        </video>
                        <div style="position: absolute; bottom: 100px; left: 20px; right: 20px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: var(--radius-md);">
                            <h3 style="color: white; margin-bottom: 5px;">ðŸŽ‰ ORGANISATION Ã‰VÃ‰NEMENTS</h3>
                            <p style="color: var(--gray-300); font-size: 14px;">DÃ©couvrez nos services d'organisation d'Ã©vÃ©nements Ã  Marseille</p>
                        </div>
                    </div>
                    
                    <!-- Story 2 - Votre deuxiÃ¨me vidÃ©o -->
                    <div class="story-slide" id="storySlide2" style="display: none;">
                        <video controls muted loop class="story-video">
                            <source src="https://files.catbox.moe/n5in11.mp4" type="video/mp4">
                            Votre navigateur ne supporte pas la lecture de vidÃ©os.
                        </video>
                        <div style="position: absolute; bottom: 100px; left: 20px; right: 20px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: var(--radius-md);">
                            <h3 style="color: white; margin-bottom: 5px;">ðŸŽ‚ ANNIVERSAIRE ENFANT</h3>
                            <p style="color: var(--gray-300); font-size: 14px;">Organisation complÃ¨te avec animations, jeux et dÃ©coration</p>
                        </div>
                    </div>
                    
                    <!-- Story 3 - Votre troisiÃ¨me vidÃ©o -->
                    <div class="story-slide" id="storySlide3" style="display: none;">
                        <video controls muted loop class="story-video">
                            <source src="https://files.catbox.moe/697ow1.mp4" type="video/mp4">
                            Votre navigateur ne supporte pas la lecture de vidÃ©os.
                        </video>
                        <div style="position: absolute; bottom: 100px; left: 20px; right: 20px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: var(--radius-md);">
                            <h3 style="color: white; margin-bottom: 5px;">ðŸ’¼ Ã‰VÃ‰NEMENTS ENTREPRISE</h3>
                            <p style="color: var(--gray-300); font-size: 14px;">Catering professionnel pour vos rÃ©unions et soirÃ©es d'entreprise</p>
                        </div>
                    </div>
                    
                    <!-- Story 4 - Votre quatriÃ¨me vidÃ©o -->
                    <div class="story-slide" id="storySlide4" style="display: none;">
                        <video controls muted loop class="story-video">
                            <source src="https://files.catbox.moe/cdff7j.mp4" type="video/mp4">
                            Votre navigateur ne supporte pas la lecture de vidÃ©os.
                        </video>
                        <div style="position: absolute; bottom: 100px; left: 20px; right: 20px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: var(--radius-md);">
                            <h3 style="color: white; margin-bottom: 5px;">ðŸ’ ORGANISATION MARIAGE</h3>
                            <p style="color: var(--gray-300); font-size: 14px;">Service complet pour votre jour spÃ©cial</p>
                        </div>
                    </div>
                    
                    <!-- Story 5 - Votre cinquiÃ¨me vidÃ©o -->
                    <div class="story-slide" id="storySlide5" style="display: none;">
                        <video controls muted loop class="story-video">
                            <source src="https://files.catbox.moe/fcgddg.mp4" type="video/mp4">
                            Votre navigateur ne supporte pas la lecture de vidÃ©os.
                        </video>
                        <div style="position: absolute; bottom: 100px; left: 20px; right: 20px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: var(--radius-md);">
                            <h3 style="color: white; margin-bottom: 5px;">ðŸ›’ PRODUITS PREMIUM</h3>
                            <p style="color: var(--gray-300); font-size: 14px;">Boissons Ã©nergisantes, accessoires, kits soirÃ©e et plus</p>
                        </div>
                    </div>
                </div>
                
                <!-- Navigation des stories -->
                <div class="story-nav">
                    <button class="story-nav-btn" onclick="prevStory()">â€¹</button>
                    <button class="story-nav-btn" onclick="nextStory()">â€º</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Product Detail Modal -->
    <div class="modal-overlay" id="productDetailModal">
        <div class="app-modal">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-info-circle"></i>
                    DÃ©tails du produit
                </div>
                <button class="modal-close" onclick="closeProductDetail()">Ã—</button>
            </div>
            <div class="modal-body">
                <img id="detailProductImage" src="" alt="Produit" class="product-detail-image">
                
                <h2 id="detailProductName" class="product-detail-name"></h2>
                <div id="detailProductPrice" class="product-detail-price"></div>
                
                <div id="detailProductDescription" class="product-detail-description"></div>
                
                <div class="product-detail-specs" id="detailProductSpecs">
                    <!-- SpÃ©cifications chargÃ©es dynamiquement -->
                </div>
                
                <!-- Tableau de prix pour Ã©vÃ©nements -->
                <div class="pricing-table" id="detailPricingTable" style="display: none;">
                    <h4><i class="fas fa-calculator"></i> Tarification Ã‰vÃ©nement</h4>
                    <div class="pricing-option">
                        <div class="person-count">
                            <i class="fas fa-user"></i>
                            <span>1-10 personnes</span>
                        </div>
                        <div>
                            <div class="event-price" id="priceBase">150â‚¬</div>
                            <div class="additional-price">Base</div>
                        </div>
                    </div>
                    <div class="pricing-option">
                        <div class="person-count">
                            <i class="fas fa-user-friends"></i>
                            <span>SupplÃ©ment par personne</span>
                        </div>
                        <div>
                            <div class="event-price" id="priceExtra">10â‚¬</div>
                            <div class="additional-price">au-delÃ  de 10</div>
                        </div>
                    </div>
                    
                    <!-- Calculateur de prix dans le dÃ©tail -->
                    <div class="price-calculator">
                        <div class="calculator-input">
                            <label>Nombre de personnes :</label>
                            <input type="number" id="detailPersonCount" min="1" max="100" value="10" onchange="calculateDetailPrice()">
                        </div>
                        <div class="calculator-result">
                            Prix total : <span id="detailEstimatedPrice">150â‚¬</span>
                        </div>
                    </div>
                </div>
                
                <div class="product-actions">
                    <div class="quantity-selector">
                        <button class="quantity-btn" onclick="detailDecrementQuantity()">-</button>
                        <input type="number" id="detailQuantityInput" value="1" min="1" class="quantity-input">
                        <button class="quantity-btn" onclick="detailIncrementQuantity()">+</button>
                    </div>
                    <button class="buy-button" id="detailBuyButton" onclick="addToCartFromDetail()">
                        Ajouter au panier
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Account Modal -->
    <div class="modal-overlay" id="accountModalOverlay">
        <div class="app-modal account-modal">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-user"></i>
                    Mon Compte
                </div>
                <button class="modal-close" onclick="closeAccountModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <!-- Section connexion/inscription -->
                <div id="loginSection">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 40px; margin-bottom: 10px;">ðŸ”</div>
                        <h3 style="color: var(--primary-white); margin-bottom: 5px;">Connexion Client</h3>
                        <p style="color: var(--gray-400); font-size: 13px;">AccÃ©dez Ã  vos avantages exclusifs</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Code client Ã  4 chiffres</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="clientCode" class="form-input" placeholder="1234" maxlength="4" style="text-align: center; letter-spacing: 10px; font-size: 24px; font-weight: 700;">
                            <button class="checkout-button" onclick="loginClient()" style="flex: 0 0 auto; padding: 0 20px;">
                                <i class="fas fa-sign-in-alt"></i>
                            </button>
                        </div>
                        <small style="color: var(--gray-500); font-size: 11px; display: block; margin-top: 5px;">Entrez votre code Ã  4 chiffres</small>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <p style="color: var(--gray-400); font-size: 13px;">Pas encore de compte ?</p>
                        <button class="checkout-button" onclick="showRegistration()" style="background: var(--gray-600); margin-top: 10px;">
                            <i class="fas fa-user-plus"></i>
                            CrÃ©er un compte
                        </button>
                    </div>
                </div>
                
                <!-- Section inscription -->
                <div id="registerSection" style="display: none;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 40px; margin-bottom: 10px;">ðŸŽ</div>
                        <h3 style="color: var(--primary-white); margin-bottom: 5px;">Inscription Client</h3>
                        <p style="color: var(--gray-400); font-size: 13px;">-5% sur toutes vos commandes</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Nom complet</label>
                        <input type="text" id="registerName" class="form-input" placeholder="Votre nom">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">TÃ©lÃ©phone</label>
                        <input type="tel" id="registerPhone" class="form-input" placeholder="06 12 34 56 78">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Choisissez un code Ã  4 chiffres</label>
                        <input type="text" id="registerCode" class="form-input" placeholder="0000" maxlength="4" style="text-align: center; letter-spacing: 10px; font-size: 24px; font-weight: 700;">
                    </div>
                    
                    <div style="background: rgba(255, 215, 0, 0.1); border-radius: var(--radius-md); padding: 12px; margin-bottom: 20px;">
                        <div style="color: var(--primary-yellow); font-weight: 600; margin-bottom: 5px; font-size: 14px;">ðŸŽ Avantages clients :</div>
                        <ul style="color: var(--gray-300); font-size: 12px; padding-left: 20px; margin: 0;">
                            <li>-5% sur toutes les commandes</li>
                            <li>Historique de vos commandes</li>
                            <li>Suivi prioritaire des livraisons</li>
                            <li>Offres exclusives</li>
                            <li>Points de fidÃ©litÃ©</li>
                            <li>SystÃ¨me de parrainage</li>
                        </ul>
                    </div>
                    
                    <button class="checkout-button" onclick="registerClient()">
                        <i class="fas fa-check"></i>
                        CrÃ©er mon compte
                    </button>
                    
                    <button class="checkout-button mt-10" style="background: var(--gray-600);" onclick="showLogin()">
                        <i class="fas fa-arrow-left"></i>
                        Retour Ã  la connexion
                    </button>
                </div>
                
                <!-- Section compte connectÃ© -->
                <div id="clientSection" style="display: none;">
                    <div class="client-info">
                        <div class="client-name" id="clientName">Mohamed Ali</div>
                        <div class="client-details">
                            <div><i class="fas fa-phone"></i> <span id="clientPhone">06 12 34 56 78</span></div>
                            <div><i class="fas fa-id-card"></i> Code client : <span id="clientCodeDisplay">1234</span></div>
                            <div><i class="fas fa-percentage"></i> RÃ©duction : <span class="client-badge">-5%</span></div>
                            <div><i class="fas fa-crown"></i> Points : <span id="clientPoints">0</span></div>
                        </div>
                    </div>
                    
                    <div class="order-history">
                        <h4 style="color: var(--primary-white); margin-bottom: 15px; font-size: 16px;">
                            <i class="fas fa-history"></i>
                            Historique des commandes
                        </h4>
                        <div id="orderHistory">
                            <!-- Commandes chargÃ©es dynamiquement -->
                        </div>
                    </div>
                    
                    <button class="checkout-button mt-20" onclick="logoutClient()" style="background: var(--gray-700);">
                        <i class="fas fa-sign-out-alt"></i>
                        DÃ©connexion
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Delivery Tracker Modal -->
    <div class="modal-overlay" id="deliveryTrackerModalOverlay">
        <div class="app-modal">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-shipping-fast"></i>
                    Suivi en direct
                </div>
                <button class="modal-close" onclick="closeDeliveryTrackerModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 40px; margin-bottom: 10px;">ðŸ“</div>
                    <div style="font-size: 18px; font-weight: 700; color: white; margin-bottom: 5px;">Votre commande #<span id="modalOrderCode">000</span></div>
                    <div style="color: var(--gray-400); font-size: 14px;">Code: <span id="modalConfirmationCode" style="color: var(--primary-yellow); font-weight: 700;">000</span></div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 12px; background: rgba(255,255,255,0.05); border-radius: var(--radius-lg); padding: 15px; margin-bottom: 20px;">
                    <div style="width: 45px; height: 45px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; color: white; font-size: 16px;">
                        M
                    </div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; color: white; margin-bottom: 4px; font-size: 14px;" id="modalDriverName">Mohamed</div>
                        <div style="font-size: 12px; color: var(--primary-yellow);" id="modalDriverPhone">06 ** ** ** **</div>
                    </div>
                </div>
                
                <div style="background: rgba(255, 152, 0, 0.1); border: 1px solid rgba(255, 152, 0, 0.2); border-radius: var(--radius-lg); padding: 15px; margin-bottom: 20px;">
                    <div style="font-size: 14px; font-weight: 700; color: var(--accent-orange); margin-bottom: 8px;">Temps estimÃ©</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-clock" style="color: var(--primary-yellow);"></i>
                        <span style="color: white; font-weight: 600;" id="modalDeliveryTime">35 minutes</span>
                    </div>
                </div>
                
                <!-- Progress Tracker amÃ©liorÃ© -->
                <div class="progress-tracker" style="margin-bottom: 20px;">
                    <div class="progress-header">
                        <div class="progress-title">Progression de la livraison</div>
                        <div class="progress-percentage" id="modalProgressPercentage">0%</div>
                    </div>
                    
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="modalProgressBar"></div>
                    </div>
                    
                    <div class="progress-steps">
                        <div class="progress-step">
                            <div class="step-icon completed" id="modalStep1">1</div>
                            <div class="step-label completed">Commande</div>
                        </div>
                        <div class="progress-step">
                            <div class="step-icon active" id="modalStep2">2</div>
                            <div class="step-label active">PrÃ©paration</div>
                        </div>
                        <div class="progress-step">
                            <div class="step-icon" id="modalStep3">3</div>
                            <div class="step-label">En route</div>
                        </div>
                        <div class="progress-step">
                            <div class="step-icon" id="modalStep4">4</div>
                            <div class="step-label">LivrÃ©</div>
                        </div>
                    </div>
                    
                    <div class="progress-time" id="modalProgressTime">
                        Temps restant: <span id="modalTimeRemaining">--</span>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 14px; font-weight: 700; color: white; margin-bottom: 10px;">Instructions</div>
                    <ul style="list-style: none; padding-left: 0;">
                        <li style="color: var(--gray-300); font-size: 13px; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-money-bill-wave" style="color: #4CAF50;"></i>
                            PrÃ©parez l'argent en espÃ¨ces
                        </li>
                        <li style="color: var(--gray-300); font-size: 13px; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-phone" style="color: #2196F3;"></i>
                            Restez disponible au tÃ©lÃ©phone
                        </li>
                        <li style="color: var(--gray-300); font-size: 13px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-qrcode" style="color: var(--primary-yellow);"></i>
                            Ayez votre code de confirmation
                        </li>
                    </ul>
                </div>
                
                <button class="checkout-button" onclick="startRealisticDeliveryTracker()">
                    <i class="fas fa-play"></i>
                    DÃ©marrer le suivi
                </button>
                
                <button class="checkout-button mt-10" style="background: var(--gray-600);" onclick="closeDeliveryTrackerModal()">
                    <i class="fas fa-times"></i>
                    Fermer
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal RÃ©servation Ã‰vÃ©nement -->
    <div class="modal-overlay" id="reservationModal">
        <div class="app-modal">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-calendar-alt"></i>
                    RÃ©server un Ã©vÃ©nement
                </div>
                <button class="modal-close" onclick="closeReservationModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div id="calendarReservation"></div>
                <div class="form-group mt-15">
                    <label class="form-label">Type d'Ã©vÃ©nement</label>
                    <select id="reservationEventType" class="form-select">
                        <option value="anniversaire_enfant">ðŸŽ‚ Anniversaire Enfant</option>
                        <option value="anniversaire_ado">ðŸŽ® Anniversaire Ado</option>
                        <option value="anniversaire_adultes">ðŸ¥³ Anniversaire Adultes</option>
                        <option value="soiree_entreprise">ðŸ’¼ SoirÃ©e Entreprise</option>
                        <option value="mariage">ðŸ’ Mariage</option>
                        <option value="soiree_privee">ðŸŽ‰ SoirÃ©e PrivÃ©e</option>
                    </select>
                </div>
                <button class="checkout-button mt-15" onclick="confirmReservation()">
                    <i class="fas fa-check"></i>
                    Confirmer la rÃ©servation
                </button>
            </div>
        </div>
    </div>
    
    <!-- Alert Notification -->
    <div id="alertModal" style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, var(--primary-yellow), var(--accent-orange)); color: var(--primary-black); padding: 15px 25px; border-radius: var(--radius-lg); box-shadow: var(--shadow-xl); z-index: 1100; display: none; align-items: center; gap: 12px; max-width: 90%; font-weight: 700; font-size: 14px; animation: slideInDown 0.4s ease-out;">
        <div style="font-size: 20px;">âœ“</div>
        <div id="alertMessage"></div>
    </div>
    
    <!-- Image Modal -->
    <div id="imageModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); z-index: 1200; justify-content: center; align-items: center; animation: fadeIn 0.3s ease-out;">
        <button onclick="closeImage()" style="position: absolute; top: 20px; right: 20px; background: rgba(255, 255, 255, 0.2); color: var(--primary-white); border: none; width: 45px; height: 45px; border-radius: 50%; font-size: 24px; cursor: pointer; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(5px);">Ã—</button>
        <img id="zoomedImage" src="" alt="Zoom" style="max-width: 90%; max-height: 90%; border-radius: var(--radius-md); box-shadow: 0 10px 40px rgba(0,0,0,0.5);">
    </div>

    <!-- Admaven Script -->
    <div id="admaven-ad-container"></div>
    <script type="text/javascript">
        (function() {
            var script = document.createElement('script');
            script.src = 'https://ads.admaven.com/server/static/ads.js';
            script.type = 'text/javascript';
            script.async = true;
            document.getElementById('admaven-ad-container').appendChild(script);
        })();
    </script>

    <script>
        // ==================== GLOBAL VARIABLES ====================
        let cart = [];
        let currentFilter = 'all';
        let deliveryMap = null;
        let currentOrderCode = '';
        let currentConfirmationCode = '';
        let currentDriverName = '';
        let currentDriverPhone = '';
        let currentDeliveryTime = '';
        let currentProductDetail = null;
        let currentLanguage = 'fr';
        let isDarkMode = true;
        let calendar = null;
        let chatOpen = false;
        let notifications = [];
        let loyaltyPoints = 0;
        let referralCount = 0;
        let referralEarnings = 0;
        let menuOpen = false;
        let deliveryTrackingInterval = null;
        let currentDeliveryProgress = 0;
        
        // Variables pour la localisation
        let userMarker = null;
        let userLocation = null;
        let isUserLocated = false;
        
        // Variables pour le systÃ¨me client
        let currentClient = null;
        const CLIENT_DISCOUNT = 5; // 5% de rÃ©duction
        
        // ADRESSE EXACTE DU MAGASIN (pour calculs internes seulement)
        const SHOP_LOCATION = [43.3275, 5.3735]; // 134 avenue de Saint-Antoine, 13015 Marseille
        const SHOP_ADDRESS = "134 avenue de Saint-Antoine, 13015 Marseille"; // Pour calculs seulement
        
        // Galerie d'Ã©vÃ©nements
        const eventGallery = [
            'https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
            'https://images.unsplash.com/photo-1530103862676-de8c9debad1d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
            'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
            'https://images.unsplash.com/photo-1465495976277-4387d4b0e4a6?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
            'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
            'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80'
        ];
        
        // Variables pour les stories
        let currentStoryIndex = 1;
        let storyTimer = null;
        let storyTimeouts = [];
        let storyProgresses = [0, 0, 0, 0, 0];
        
        // Tous les produits - ORGANISATION AMÃ‰LIORÃ‰E
        let products = [
            // ==================== CATÃ‰GORIE PRODUITS NORMAUX ====================
            {
                id: 1,
                name: "Creme Deluxe",
                price: 25.00,
                image: "https://mcusercontent.com/ecbcd3e0a3ef2c00dbcaefee8/images/bc49a018-064b-af44-b264-1f821d3f40e0.jpg",
                description: "Creme premium pour soirÃ©e, texture lÃ©gÃ¨re, parfum discret, qualitÃ© supÃ©rieure",
                category: "accessoires",
                available: true,
                specs: [
                    "âœ… QualitÃ© premium",
                    "âœ… Texture lÃ©gÃ¨re",
                    "âœ… Parfum discret",
                    "âœ… Longue durÃ©e",
                    "âœ… Sans rÃ©sidus",
                    "âœ… FabriquÃ© en UE"
                ],
                size: "50ml",
                isPopular: false
            },
            {
                id: 2,
                name: "Fast Gaz",
                price: 20.00,
                image: "https://mcusercontent.com/ecbcd3e0a3ef2c00dbcaefee8/images/d6ff08ad-78f0-2424-b67f-1a9f23db736c.jpeg",
                description: "Gaz rapide de qualitÃ© professionnelle, allumage instantanÃ©, durÃ©e prolongÃ©e",
                category: "accessoires",
                available: true,
                specs: [
                    "âœ… Allumage instantanÃ©",
                    "âœ… DurÃ©e prolongÃ©e",
                    "âœ… QualitÃ© pro",
                    "âœ… SÃ©curitÃ© maximale",
                    "âœ… Sans odeur",
                    "âœ… Garantie qualitÃ©"
                ],
                size: "250ml",
                isPopular: false
            },
            {
                id: 3,
                name: "Canette de Coca",
                price: 2.00,
                image: "https://mcusercontent.com/ecbcd3e0a3ef2c00dbcaefee8/images/6a1f1093-3c42-4461-4910-e78105e654f3.jpeg",
                description: "Canette Coca-Cola 33cl, rafraÃ®chissement classique, parfait pour les Ã©vÃ©nements",
                category: "boissons",
                available: true,
                specs: [
                    "âœ… 33cl",
                    "âœ… RafraÃ®chissant",
                    "âœ… Parfait Ã©vÃ©nements",
                    "âœ… Emballage individuel",
                    "âœ… Frais garanti",
                    "âœ… Lot disponible"
                ],
                size: "33cl",
                isPopular: false
            },
            {
                id: 8,
                name: "Vodka Premium (70cl)",
                price: 19.00,
                image: "https://mcusercontent.com/ecbcd3e0a3ef2c00dbcaefee8/images/f8d0504d-2c8a-189b-08f5-3b0f48964823.jpeg",
                description: "Vodka premium 70cl, qualitÃ© supÃ©rieure, parfaite pour cocktails et Ã©vÃ©nements",
                category: "alcools",
                available: true,
                specs: [
                    "âœ… 70cl",
                    "âœ… QualitÃ© premium",
                    "âœ… Parfaite cocktails",
                    "âœ… Bouteille originale",
                    "âœ… Service Ã©vÃ©nements",
                    "âœ… Livraison sÃ©curisÃ©e"
                ],
                size: "70cl",
                isPopular: false
            },
            {
                id: 9,
                name: "OCB Slim Noir",
                price: 25.00,
                image: "https://mcusercontent.com/ecbcd3e0a3ef2c00dbcaefee8/images/d24ccf63-fd85-0b81-e6a0-a401cfb11d52.jpeg",
                description: "Papier Ã  rouler premium noir, ultra fin, brÃ»lure lente et rÃ©guliÃ¨re",
                category: "accessoires",
                available: true,
                specs: [
                    "âœ… Papier ultra fin",
                    "âœ… BrÃ»lure lente",
                    "âœ… QualitÃ© premium",
                    "âœ… Colle naturelle",
                    "âœ… 50 feuilles",
                    "âœ… Made in France"
                ],
                size: "Paquet de 50",
                isPopular: true
            },
            {
                id: 10,
                name: "OCB Marron",
                price: 25.00,
                image: "https://mcusercontent.com/ecbcd3e0a3ef2c00dbcaefee8/images/cce76e99-720f-a078-7a66-76e9c737abd3.jpeg",
                description: "Papier Ã  rouler naturel marron, sans chlore, Ã©cologique, brÃ»lure parfaite",
                category: "accessoires",
                available: true,
                specs: [
                    "âœ… 100% naturel",
                    "âœ… Sans chlore",
                    "âœ… Ã‰cologique",
                    "âœ… BrÃ»lure parfaite",
                    "âœ… 50 feuilles",
                    "âœ… QualitÃ© supÃ©rieure"
                ],
                size: "Paquet de 50",
                isPopular: true
            },
            {
                id: 12,
                name: "Chargeur Rapide",
                price: 12.00,
                image: "https://mcusercontent.com/ecbcd3e0a3ef2c00dbcaefee8/images/1dda42ab-34ae-13a0-11ce-f5dcf16750a4.jpeg",
                description: "Chargeur allume-cigarette USB, recharge rapide, compatible voiture et prise murale",
                category: "accessoires",
                available: true,
                specs: [
                    "âœ… Charge rapide",
                    "âœ… USB compatible",
                    "âœ… Voiture/maison",
                    "âœ… SÃ©curitÃ© intÃ©grÃ©e",
                    "âœ… Longue durÃ©e",
                    "âœ… Garantie 1 an"
                ],
                size: "Standard",
                isPopular: false
            },
            {
                id: 13,
                name: "Nike TN",
                price: 80.00,
                image: "https://mcusercontent.com/ecbcd3e0a3ef2c00dbcaefee8/images/2c645765-5df4-27c4-c8d5-798f09b5da45.jpeg",
                description: "Sneakers Nike TN authentiques, confort maximal, style urbain, plusieurs coloris disponibles",
                category: "accessoires",
                available: true,
                specs: [
                    "âœ… Authentique Nike",
                    "âœ… Confort maximal",
                    "âœ… Style urbain",
                    "âœ… Plusieurs coloris",
                    "âœ… Toutes pointures",
                    "âœ… BoÃ®te originale"
                ],
                size: "36-46",
                isPopular: true
            },
            {
                id: 14,
                name: "Casque Bluetooth",
                price: 30.00,
                image: "https://mcusercontent.com/ecbcd3e0a3ef2c00dbcaefee8/images/e0285ed8-8ed9-f98a-34dc-f69c58a2478f.jpeg",
                description: "Ã‰couteurs sans fil Bluetooth, autonomie 8h, qualitÃ© son HD, Ã©tanches Ã  la sueur",
                category: "accessoires",
                available: true,
                specs: [
                    "âœ… Sans fil Bluetooth",
                    "âœ… Autonomie 8h",
                    "âœ… QualitÃ© HD",
                    "âœ… Ã‰tanche sueur",
                    "âœ… Micro intÃ©grÃ©",
                    "âœ… Charge rapide"
                ],
                size: "Universal",
                isPopular: true
            },
            {
                id: 200,
                name: "Menu d'Affaires Premium",
                price: 25.00,
                image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "Menu complet rÃ©unions d'affaires : entrÃ©e, plat, dessert, boisson chaude",
                category: "repas",
                available: true,
                specs: [
                    "âœ… EntrÃ©e au choix",
                    "âœ… Plat principal",
                    "âœ… Dessert maison",
                    "âœ… Boisson chaude",
                    "âœ… Livraison chaude",
                    "âœ… Emballage premium"
                ],
                size: "Portion complÃ¨te",
                isPopular: false
            },
            {
                id: 300,
                name: "Catering Mariage",
                price: 500.00,
                image: "https://images.unsplash.com/photo-1465495976277-4387d4b0e4a6?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "Service catering mariage avec buffet chaud et froid, service traiteur, installation",
                category: "catering",
                available: true,
                specs: [
                    "âœ… Buffet chaud/froid",
                    "âœ… Service traiteur",
                    "âœ… Installation complÃ¨te",
                    "âœ… Personnel service",
                    "âœ… Nettoyage inclus",
                    "âœ… Service 5h minimum"
                ],
                size: "Pour 30 personnes",
                isPopular: false
            },
            
            // ==================== CATÃ‰GORIE ACCESSOIRES POPULAIRES ====================
            {
                id: 15,
                name: "Montre ConnectÃ©e",
                price: 45.00,
                image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "Montre connectÃ©e avec Ã©cran AMOLED, suivi d'activitÃ©, notifications, 7 jours autonomie",
                category: "accessoires",
                available: true,
                specs: [
                    "âœ… Ã‰cran AMOLED",
                    "âœ… Autonomie 7 jours",
                    "âœ… Ã‰tanche IP68",
                    "âœ… Suivi santÃ©",
                    "âœ… Notifications",
                    "âœ… Charge rapide"
                ],
                size: "Universal",
                isPopular: true
            },
            
            // ==================== CATÃ‰GORIE Ã‰VÃ‰NEMENTS ====================
            {
                id: 1000,
                name: "ðŸŽ‚ Anniversaire Enfant (5-12 ans)",
                price: 150.00,
                image: "https://images.unsplash.com/photo-1530103862676-de8c9debad1d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "Pack complet anniversaire enfant avec animations, jeux, dÃ©coration, gÃ¢teau, bonbons et boissons",
                category: "evenements",
                available: true,
                specs: [
                    "âœ… Pour 10 enfants maximum",
                    "âœ… Animations incluses (2h)",
                    "âœ… DÃ©coration sur thÃ¨me",
                    "âœ… GÃ¢teau personnalisÃ©",
                    "âœ… Boissons et bonbons",
                    "âœ… Service de 3h",
                    "âœ… Photos souvenirs"
                ],
                size: "Pack 10 personnes",
                isPopular: false,
                pricing: {
                    base: 150,
                    extraPerPerson: 10,
                    basePersons: 10
                }
            },
            {
                id: 1001,
                name: "ðŸŽ® Anniversaire Ado (13-17 ans)",
                price: 250.00,
                image: "https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "SoirÃ©e gaming ou musique, snacks premium, boissons Ã©nergisantes, dÃ©coration moderne",
                category: "evenements",
                available: true,
                specs: [
                    "âœ… Pour 15 ados maximum",
                    "âœ… Setup gaming ou musique",
                    "âœ… Snacks premium",
                    "âœ… Boissons Ã©nergisantes",
                    "âœ… DÃ©coration moderne",
                    "âœ… Service de 4h",
                    "âœ… SÃ©curitÃ© incluse"
                ],
                size: "Pack 15 personnes",
                isPopular: false,
                pricing: {
                    base: 250,
                    extraPerPerson: 15,
                    basePersons: 15
                }
            },
            {
                id: 1002,
                name: "ðŸ¥³ Anniversaire Adultes",
                price: 350.00,
                image: "https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "SoirÃ©e cocktail, buffet premium, musique, dÃ©coration Ã©lÃ©gante, service professionnel",
                category: "evenements",
                available: true,
                specs: [
                    "âœ… Pour 20 adultes maximum",
                    "âœ… Cocktail d'accueil",
                    "âœ… Buffet premium",
                    "âœ… Playlist personnalisÃ©e",
                    "âœ… DÃ©coration Ã©lÃ©gante",
                    "âœ… Service de 5h",
                    "âœ… Barman professionnel"
                ],
                size: "Pack 20 personnes",
                isPopular: false,
                pricing: {
                    base: 350,
                    extraPerPerson: 15,
                    basePersons: 20
                }
            },
            {
                id: 1003,
                name: "ðŸ’¼ SoirÃ©e Entreprise",
                price: 500.00,
                image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "Ã‰vÃ©nement professionnel avec catering haut de gamme, service traiteur, installation complÃ¨te",
                category: "evenements",
                available: true,
                specs: [
                    "âœ… Jusqu'Ã  30 personnes",
                    "âœ… Catering professionnel",
                    "âœ… Service traiteur",
                    "âœ… Installation complÃ¨te",
                    "âœ… Nettoyage inclus",
                    "âœ… Personnel dÃ©diÃ©",
                    "âœ… MatÃ©riel fourni"
                ],
                size: "Pack 30 personnes",
                isPopular: false,
                pricing: {
                    base: 500,
                    extraPerPerson: 20,
                    basePersons: 30
                }
            },
            {
                id: 1004,
                name: "ðŸ’ Organisation Mariage",
                price: 1200.00,
                image: "https://images.unsplash.com/photo-1465495976277-4387d4b0e4a6?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "Service complet mariage : dÃ©coration, catering, animation, coordination, logistique",
                category: "evenements",
                available: true,
                specs: [
                    "âœ… Coordination complÃ¨te",
                    "âœ… DÃ©coration sur mesure",
                    "âœ… Catering mariage",
                    "âœ… Animation musicale",
                    "âœ… Photographie option",
                    "âœ… Service 8h minimum",
                    "âœ… Gestion logistique"
                ],
                size: "Service complet",
                isPopular: false,
                pricing: {
                    base: 1200,
                    extraPerPerson: 50,
                    basePersons: 50
                }
            },
            {
                id: 1005,
                name: "ðŸŽ‰ SoirÃ©e PrivÃ©e",
                price: 400.00,
                image: "https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "Organisation soirÃ©e privÃ©e Ã  domicile avec bar mobile, snacks, musique et ambiance",
                category: "evenements",
                available: true,
                specs: [
                    "âœ… Jusqu'Ã  25 personnes",
                    "âœ… Bar mobile",
                    "âœ… Snacks variÃ©s",
                    "âœ… Playlist personnalisÃ©e",
                    "âœ… DÃ©coration ambiance",
                    "âœ… Service de 6h",
                    "âœ… Gestion complÃ¨te"
                ],
                size: "Pack 25 personnes",
                isPopular: false,
                pricing: {
                    base: 400,
                    extraPerPerson: 15,
                    basePersons: 25
                }
            },
            {
                id: 1006,
                name: "ðŸ‘¶ Baby Shower",
                price: 200.00,
                image: "https://images.unsplash.com/photo-1553452118-621e1f860f43?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "Organisation baby shower avec dÃ©coration thÃ©matique, jeux, buffet lÃ©ger et surprises",
                category: "evenements",
                available: true,
                specs: [
                    "âœ… Pour 15 personnes",
                    "âœ… DÃ©coration thÃ©matique",
                    "âœ… Jeux et animations",
                    "âœ… Buffet lÃ©ger",
                    "âœ… GÃ¢teau personnalisÃ©",
                    "âœ… Service de 4h",
                    "âœ… Photos souvenirs"
                ],
                size: "Pack 15 personnes",
                isPopular: false,
                pricing: {
                    base: 200,
                    extraPerPerson: 10,
                    basePersons: 15
                }
            },
            {
                id: 1007,
                name: "ðŸ¢ Ã‰vÃ©nement Professionnel",
                price: 800.00,
                image: "https://images.unsplash.com/photo-1542744173-8e7e53415bb0?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                description: "Organisation Ã©vÃ©nements pros : lancement produit, confÃ©rence, sÃ©minaire avec service premium",
                category: "evenements",
                available: true,
                specs: [
                    "âœ… Jusqu'Ã  50 personnes",
                    "âœ… Installation technique",
                    "âœ… Catering professionnel",
                    "âœ… MatÃ©riel audiovisuel",
                    "âœ… Accueil personnalisÃ©",
                    "âœ… Service journÃ©e complÃ¨te",
                    "âœ… Support technique"
                ],
                size: "Pack 50 personnes",
                isPopular: false,
                pricing: {
                    base: 800,
                    extraPerPerson: 25,
                    basePersons: 50
                }
            }
        ];

        // ==================== INITIALISATION ====================
        document.addEventListener('DOMContentLoaded', function() {
            initTheme();
            initDeliveryMap();
            initEventListeners();
            loadCartFromStorage();
            checkActiveOrder();
            initPayPal();
            checkClientStatus();
            initAccountButton();
            loadLoyaltyData();
            initGallery();
            initCalendar();
            initNotifications();
            updateLanguage();
            updateMenuDisplay();
            
            // Afficher la section produits par dÃ©faut
            showProductsSection();
            
            setInterval(checkForNotifications, 30000);
        });

        // ==================== FONCTIONS DE NAVIGATION PAR SECTIONS ====================
        
        function showProductsSection() {
            // Masquer toutes les sections
            document.getElementById('productsSection').style.display = 'none';
            document.getElementById('accessoriesSection').style.display = 'none';
            document.getElementById('eventsSection').style.display = 'none';
            document.getElementById('infoSection').style.display = 'none';
            document.getElementById('trackerSection').style.display = 'none';
            
            // Afficher la section produits
            document.getElementById('productsSection').style.display = 'block';
            
            // Activer le bouton correspondant
            updateActiveNavButton('products');
            
            // Charger les produits normaux
            currentFilter = 'all';
            renderProducts();
            
            // Fermer le menu si ouvert
            if (menuOpen) toggleMenu();
        }
        
        function showAccessoriesSection() {
            // Masquer toutes les sections
            document.getElementById('productsSection').style.display = 'none';
            document.getElementById('accessoriesSection').style.display = 'none';
            document.getElementById('eventsSection').style.display = 'none';
            document.getElementById('infoSection').style.display = 'none';
            document.getElementById('trackerSection').style.display = 'none';
            
            // Afficher la section accessoires populaires
            document.getElementById('accessoriesSection').style.display = 'block';
            
            // Activer le bouton correspondant
            updateActiveNavButton('accessories');
            
            // Charger les produits populaires
            renderAccessories();
            
            // Fermer le menu si ouvert
            if (menuOpen) toggleMenu();
        }
        
        function showEventsSection() {
            // Masquer toutes les sections
            document.getElementById('productsSection').style.display = 'none';
            document.getElementById('accessoriesSection').style.display = 'none';
            document.getElementById('eventsSection').style.display = 'none';
            document.getElementById('infoSection').style.display = 'none';
            document.getElementById('trackerSection').style.display = 'none';
            
            // Afficher la section Ã©vÃ©nements
            document.getElementById('eventsSection').style.display = 'block';
            
            // Activer le bouton correspondant
            updateActiveNavButton('events');
            
            // Charger les Ã©vÃ©nements
            renderEvents();
            
            // Fermer le menu si ouvert
            if (menuOpen) toggleMenu();
        }
        
        function showInfoSection() {
            // Masquer toutes les sections
            document.getElementById('productsSection').style.display = 'none';
            document.getElementById('accessoriesSection').style.display = 'none';
            document.getElementById('eventsSection').style.display = 'none';
            document.getElementById('infoSection').style.display = 'none';
            document.getElementById('trackerSection').style.display = 'none';
            
            // Afficher la section info
            document.getElementById('infoSection').style.display = 'block';
            
            // Activer le bouton correspondant
            updateActiveNavButton('info');
            
            // Fermer le menu si ouvert
            if (menuOpen) toggleMenu();
        }
        
        function scrollToSection(sectionId) {
            // Masquer toutes les sections
            document.getElementById('productsSection').style.display = 'none';
            document.getElementById('accessoriesSection').style.display = 'none';
            document.getElementById('eventsSection').style.display = 'none';
            document.getElementById('infoSection').style.display = 'none';
            document.getElementById('trackerSection').style.display = 'none';
            
            // Afficher la section demandÃ©e
            document.getElementById(sectionId + 'Section').style.display = 'block';
            
            // Activer le bouton correspondant
            updateActiveNavButton(sectionId);
            
            // Si c'est la section tracker, s'assurer qu'elle est visible
            if (sectionId === 'tracker') {
                document.getElementById('trackerSection').scrollIntoView({ behavior: 'smooth' });
            }
            
            // Fermer le menu si ouvert
            if (menuOpen) toggleMenu();
        }
        
        function updateActiveNavButton(section) {
            // Retirer la classe active de tous les boutons
            document.querySelectorAll('.quick-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Ajouter la classe active au bouton correspondant
            const buttons = document.querySelectorAll('.quick-nav-btn');
            switch(section) {
                case 'products':
                    buttons[0].classList.add('active');
                    break;
                case 'accessories':
                    buttons[1].classList.add('active');
                    break;
                case 'events':
                    buttons[2].classList.add('active');
                    break;
                case 'tracker':
                    buttons[3].classList.add('active');
                    break;
                case 'info':
                    buttons[4].classList.add('active');
                    break;
            }
        }
        
        // ==================== FONCTIONS MENU ====================
        
        function toggleMenu() {
            const menu = document.getElementById('verticalMenu');
            menuOpen = !menuOpen;
            
            if (menuOpen) {
                menu.classList.add('active');
                document.body.style.overflow = 'hidden';
            } else {
                menu.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }
        
        function updateMenuDisplay() {
            // Mettre Ã  jour le compteur du panier dans le menu
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('menuCartCount').textContent = totalItems;
            
            // Mettre Ã  jour le compteur de notifications
            const unreadNotifications = notifications.filter(n => !n.read).length;
            document.getElementById('menuNotificationCount').textContent = unreadNotifications;
            
            // Mettre Ã  jour la langue
            document.getElementById('menuLang').textContent = currentLanguage.toUpperCase();
            
            // Mettre Ã  jour le mode sombre/clair
            document.getElementById('menuTheme').textContent = isDarkMode ? 'ON' : 'OFF';
            document.getElementById('menuThemeIcon').className = isDarkMode ? 'fas fa-moon' : 'fas fa-sun';
            
            // Mettre Ã  jour les informations mÃ©tÃ©o dans le menu
            document.getElementById('menuWeatherTemp').textContent = '28Â°C';
            
            // Mettre Ã  jour les points de fidÃ©litÃ© dans le menu
            document.getElementById('menuLoyaltyPoints').textContent = loyaltyPoints + ' pts';
            
            // Mettre Ã  jour les gains de parrainage dans le menu
            document.getElementById('menuReferralEarnings').textContent = referralEarnings + 'â‚¬';
        }

        // ==================== RENDU DES PRODUITS PAR SECTION ====================
        
        function renderProducts() {
            const productsGrid = document.getElementById('productsGrid');
            if (!productsGrid) return;
            
            productsGrid.innerHTML = '';
            
            // Filtrer les produits normaux (pas Ã©vÃ©nements, pas populaires)
            let filteredProducts = products.filter(product => 
                product.category !== 'evenements' && !product.isPopular
            );
            
            // Appliquer le filtre de catÃ©gorie
            if (currentFilter !== 'all') {
                filteredProducts = filteredProducts.filter(product => product.category === currentFilter);
            }
            
            filteredProducts.forEach(product => {
                renderProductCard(product, productsGrid);
            });
        }
        
        function renderAccessories() {
            const accessoriesGrid = document.getElementById('accessoriesGrid');
            if (!accessoriesGrid) return;
            
            accessoriesGrid.innerHTML = '';
            
            // Filtrer les produits populaires
            const popularProducts = products.filter(product => product.isPopular);
            
            popularProducts.forEach(product => {
                renderProductCard(product, accessoriesGrid);
            });
        }
        
        function renderEvents() {
            const eventsGrid = document.getElementById('eventsGrid');
            if (!eventsGrid) return;
            
            eventsGrid.innerHTML = '';
            
            // Filtrer les Ã©vÃ©nements
            const eventProducts = products.filter(product => product.category === 'evenements');
            
            eventProducts.forEach(product => {
                renderProductCard(product, eventsGrid);
            });
        }
        
        function renderProductCard(product, container) {
            const discountedPrice = currentClient && product.category !== 'evenements' ? 
                product.price * (1 - CLIENT_DISCOUNT / 100) : product.price;
            
            const productHTML = `
                <div class="product-card">
                    ${product.available && product.category === 'evenements' ? 
                        `<div class="product-badge" style="background: rgba(156,39,176,0.2); color: #9C27B0; border-color: rgba(156,39,176,0.3);">ðŸŽŠ Ã‰VÃ‰NEMENT</div>` : ''}
                    ${product.available && product.isPopular ? 
                        `<div class="product-badge" style="background: rgba(255,152,0,0.2); color: #FF9800; border-color: rgba(255,152,0,0.3);">ðŸ”¥ POPULAIRE</div>` : ''}
                    ${!product.available ? 
                        `<div class="product-badge" style="background: rgba(255,82,82,0.2); color: #FF5252; border-color: rgba(255,82,82,0.3);">Indisponible</div>` : ''}
                    
                    <div class="product-image-container">
                        <img src="${product.image}" 
                             alt="${product.name}" 
                             class="product-image"
                             onclick="showImage('${product.image}')"
                             onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 400 300%22><rect width=%22400%22 height=%22300%22 fill=%22#111%22/><text x=%22200%22 y=%22160%22 font-family=%22Inter%22 font-size=%2224%22 fill=%22%23FFD700%22 text-anchor=%22middle%22>H.D.S SHOP</text><text x=%22200%22 y=%22190%22 font-family=%22Inter%22 font-size=%2216%22 fill=%22%23FFD700%22 text-anchor=%22middle%22>${product.name}</text></svg>'">
                    </div>
                    
                    <div class="product-name">${product.name}</div>
                    <div class="product-price">
                        ${currentClient && product.category !== 'evenements' ? 
                            `<span class="original-price">${product.price.toFixed(2)}â‚¬</span>
                             <span class="discounted-price">${discountedPrice.toFixed(2)}â‚¬</span>
                             <span class="client-badge">-${CLIENT_DISCOUNT}%</span>` : 
                            `${product.price.toFixed(2)}â‚¬`}
                    </div>
                    <div class="product-description">${product.description}</div>
                    
                    <button class="product-details-btn" onclick="openProductDetail(${product.id})">
                        <i class="fas fa-info-circle"></i> Voir dÃ©tails
                    </button>
                    
                    <div class="product-actions">
                        <div class="quantity-selector">
                            <button class="quantity-btn" onclick="decrementQuantity(this)">-</button>
                            <input type="number" value="1" min="1" class="quantity-input">
                            <button class="quantity-btn" onclick="incrementQuantity(this)">+</button>
                        </div>
                        <button class="buy-button" onclick="addToCartWithQuantity(${product.id}, this)" ${!product.available ? 'disabled' : ''}>
                            ${!product.available ? 'Indisponible' : 'Ajouter'}
                        </button>
                    </div>
                </div>
            `;
            container.innerHTML += productHTML;
        }
        
        // ==================== FONCTION ACCORDÃ‰ON EXCLUSIVE ====================
        function toggleAccordion(header) {
            const accordion = header.closest('.accordion-item');
            const content = accordion.querySelector('.accordion-content');
            const isOpen = content.classList.contains('open');
            
            // Fermer tous les autres accordÃ©ons
            document.querySelectorAll('.accordion-content.open').forEach(item => {
                if (item !== content) {
                    item.classList.remove('open');
                    item.previousElementSibling.classList.remove('active');
                }
            });
            
            // Basculer l'accordÃ©on courant
            if (!isOpen) {
                content.classList.add('open');
                header.classList.add('active');
            } else {
                content.classList.remove('open');
                header.classList.remove('active');
            }
        }
        
        // ==================== FONCTIONS POUR DÃ‰TECTER SI LE PANIER CONTIENT UN Ã‰VÃ‰NEMENT ====================
        
        function cartContainsEvent() {
            return cart.some(item => {
                const product = products.find(p => p.id === item.id);
                return product && product.category === 'evenements';
            });
        }
        
        function getEventInCart() {
            for (let item of cart) {
                const product = products.find(p => p.id === item.id);
                if (product && product.category === 'evenements') {
                    return product;
                }
            }
            return null;
        }
        
        // ==================== MISE Ã€ JOUR DU FORMULAIRE DE COMMANDE ====================
        
        function updateCheckoutForm() {
            const hasEvent = cartContainsEvent();
            const eventSection = document.getElementById('eventFormSection');
            const normalSection = document.getElementById('normalFormSection');
            
            // Mettre Ã  jour le type de commande
            document.getElementById('orderTypeInput').value = hasEvent ? 'evenement' : 'normal';
            
            if (hasEvent) {
                // Afficher le formulaire Ã©vÃ©nement
                eventSection.style.display = 'block';
                normalSection.style.display = 'none';
                
                // Remplir automatiquement le type d'Ã©vÃ©nement
                const eventProduct = getEventInCart();
                if (eventProduct) {
                    updateEventTypeFromProduct(eventProduct.name);
                    calculateEventPrice();
                }
            } else {
                // Afficher le formulaire normal
                eventSection.style.display = 'none';
                normalSection.style.display = 'block';
            }
            
            // Mettre Ã  jour PayPal
            initPayPal();
        }
        
        function updateEventTypeFromProduct(productName) {
            const select = document.querySelector('select[name="type_evenement"]');
            const eventTypes = {
                'anniversaire enfant': 'anniversaire_enfant',
                'anniversaire ado': 'anniversaire_ado',
                'anniversaire adultes': 'anniversaire_adultes',
                'soirÃ©e entreprise': 'soiree_entreprise',
                'mariage': 'mariage',
                'soirÃ©e privÃ©e': 'soiree_privee',
                'baby shower': 'baby_shower',
                'Ã©vÃ©nement professionnel': 'evenement_pro'
            };
            
            for (let [key, value] of Object.entries(eventTypes)) {
                if (productName.toLowerCase().includes(key)) {
                    select.value = value;
                    break;
                }
            }
        }
        
        // ==================== VALIDATION ET SOUMISSION AMÃ‰LIORÃ‰E ====================
        
        function validateAndSubmitOrder() {
            const hasEvent = cartContainsEvent();
            
            if (hasEvent) {
                // Validation pour Ã©vÃ©nement
                const eventType = document.querySelector('select[name="type_evenement"]').value;
                const eventDate = document.querySelector('input[name="date_evenement"]').value;
                const eventTime = document.querySelector('select[name="heure_evenement"]').value;
                const eventPersons = document.querySelector('select[name="nombre_personnes"]').value;
                
                if (!eventType || !eventDate || !eventTime || !eventPersons) {
                    showAlert('âŒ Veuillez remplir tous les champs pour l\'Ã©vÃ©nement.', 'error');
                    return;
                }
                
                // Utiliser les champs Ã©vÃ©nement
                document.querySelector('input[name="nom"]').value = document.querySelector('input[name="nom_evenement"]').value;
                document.querySelector('input[name="telephone"]').value = document.querySelector('input[name="telephone_evenement"]').value;
                document.querySelector('textarea[name="adresse"]').value = document.querySelector('textarea[name="adresse_evenement"]').value;
                document.querySelector('textarea[name="instructions"]').value = document.querySelector('textarea[name="instructions_evenement"]').value;
                
                // Mettre Ã  jour les champs cachÃ©s avec les informations d'Ã©vÃ©nement
                document.getElementById('orderTypeInput').value = 'evenement';
                
            } else {
                // Validation pour commande normale
                const nom = document.querySelector('input[name="nom"]').value;
                const telephone = document.querySelector('input[name="telephone"]').value;
                const adresse = document.querySelector('textarea[name="adresse"]').value;
                
                if (!nom || !telephone || !adresse) {
                    showAlert('âŒ Veuillez remplir tous les champs obligatoires.', 'error');
                    return;
                }
                
                document.getElementById('orderTypeInput').value = 'normal';
            }
            
            // Soumettre la commande
            submitOrder();
        }
        
        // ==================== SYSTÃˆME DE LOCALISATION ====================
        function locateUser() {
            const button = document.getElementById('locateMeButton');
            const distanceDisplay = document.getElementById('distanceDisplay');
            const distanceText = document.getElementById('distanceText');
            
            button.disabled = true;
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Localisation...';
            
            distanceDisplay.style.display = 'block';
            distanceText.textContent = 'Localisation en cours...';
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        const userLat = position.coords.latitude;
                        const userLng = position.coords.longitude;
                        userLocation = [userLat, userLng];
                        
                        // Calculer la distance
                        const distance = calculateDistance(SHOP_LOCATION[0], SHOP_LOCATION[1], userLat, userLng);
                        const zone = getZoneByDistance(distance);
                        
                        // Afficher la distance
                        distanceText.innerHTML = `<strong>${distance.toFixed(1)} km</strong> du magasin â€¢ ${zone}`;
                        
                        // Ajouter un marqueur sur la carte
                        if (userMarker) {
                            deliveryMap.removeLayer(userMarker);
                        }
                        
                        userMarker = L.marker([userLat, userLng], {
                            icon: L.divIcon({
                                html: '<div style="background: #2196F3; width: 40px; height: 40px; border-radius: 50%; border: 3px solid white; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 20px rgba(33, 150, 243, 0.7);"><i class="fas fa-user" style="color: white; font-size: 18px;"></i></div>',
                                iconSize: [40, 40],
                                iconAnchor: [20, 40],
                                className: 'user-marker'
                            })
                        }).addTo(deliveryMap);
                        
                        // Centrer la carte sur l'utilisateur
                        deliveryMap.setView([userLat, userLng], 13);
                        
                        // Tracer une ligne entre le magasin et l'utilisateur
                        L.polyline([SHOP_LOCATION, [userLat, userLng]], {
                            color: '#2196F3',
                            weight: 3,
                            opacity: 0.7,
                            dashArray: '10, 10'
                        }).addTo(deliveryMap);
                        
                        // Mettre Ã  jour le bouton
                        button.innerHTML = '<i class="fas fa-check"></i> LocalisÃ©';
                        button.style.background = 'linear-gradient(135deg, #4CAF50, #2E7D32)';
                        isUserLocated = true;
                        
                        // Sauvegarder la localisation
                        localStorage.setItem('hds_shop_user_location', JSON.stringify({
                            lat: userLat,
                            lng: userLng,
                            distance: distance,
                            zone: zone,
                            timestamp: Date.now()
                        }));
                        
                        showAlert('ðŸ“ Localisation rÃ©ussie ! Distance calculÃ©e.');
                        
                        // Fermer le menu si ouvert
                        if (menuOpen) {
                            toggleMenu();
                        }
                    },
                    function(error) {
                        console.error('Erreur de gÃ©olocalisation:', error);
                        
                        // Simulation pour le dÃ©veloppement
                        simulateLocation();
                        
                        button.disabled = false;
                        button.innerHTML = '<i class="fas fa-location-dot"></i> Me localiser';
                        distanceText.textContent = 'Erreur de localisation. Simulation activÃ©e.';
                        
                        showAlert('âš ï¸ Utilisation de la simulation de localisation', 'warning');
                        
                        // Fermer le menu si ouvert
                        if (menuOpen) {
                            toggleMenu();
                        }
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
            } else {
                // GÃ©olocalisation non supportÃ©e
                simulateLocation();
                
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-location-dot"></i> Me localiser';
                distanceText.textContent = 'GÃ©olocalisation non supportÃ©e. Simulation activÃ©e.';
                
                showAlert('âš ï¸ Simulation de localisation activÃ©e', 'warning');
                
                // Fermer le menu si ouvert
                if (menuOpen) {
                    toggleMenu();
                }
            }
        }
        
        function simulateLocation() {
            // Simulation de position dans Marseille
            const marseilleDistricts = [
                {name: "Vieux Port", coords: [43.2950, 5.3750]},
                {name: "La Plaine", coords: [43.2900, 5.3820]},
                {name: "Endoume", coords: [43.2850, 5.3650]},
                {name: "PrÃ©fecture", coords: [43.3030, 5.3800]},
                {name: "Saint-Just", coords: [43.3150, 5.3950]}
            ];
            
            const randomDistrict = marseilleDistricts[Math.floor(Math.random() * marseilleDistricts.length)];
            userLocation = randomDistrict.coords;
            
            const distance = calculateDistance(SHOP_LOCATION[0], SHOP_LOCATION[1], randomDistrict.coords[0], randomDistrict.coords[1]);
            const zone = getZoneByDistance(distance);
            
            const distanceText = document.getElementById('distanceText');
            distanceText.innerHTML = `<strong>${distance.toFixed(1)} km</strong> du magasin â€¢ ${zone} â€¢ ${randomDistrict.name}`;
            
            // Ajouter un marqueur sur la carte
            if (userMarker) {
                deliveryMap.removeLayer(userMarker);
            }
            
            userMarker = L.marker(randomDistrict.coords, {
                icon: L.divIcon({
                    html: '<div style="background: #2196F3; width: 40px; height: 40px; border-radius: 50%; border: 3px solid white; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 20px rgba(33, 150, 243, 0.7);"><i class="fas fa-user" style="color: white; font-size: 18px;"></i></div>',
                    iconSize: [40, 40],
                    iconAnchor: [20, 40],
                    className: 'user-marker'
                })
            }).addTo(deliveryMap);
            
            // Tracer une ligne entre le magasin et l'utilisateur
            L.polyline([SHOP_LOCATION, randomDistrict.coords], {
                color: '#2196F3',
                weight: 3,
                opacity: 0.7,
                dashArray: '10, 10'
            }).addTo(deliveryMap);
            
            const button = document.getElementById('locateMeButton');
            button.innerHTML = '<i class="fas fa-check"></i> LocalisÃ© (simulation)';
            button.style.background = 'linear-gradient(135deg, #2196F3, #1976D2)';
            isUserLocated = true;
        }
        
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Rayon de la Terre en km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }
        
        function getZoneByDistance(distanceKm) {
            if (distanceKm <= 2) return "Zone Centre";
            else if (distanceKm <= 5) return "Zone Proche";
            else if (distanceKm <= 10) return "Zone Moyenne";
            else return "Zone Ã‰loignÃ©e";
        }
        
        // ==================== SYSTÃˆME CLIENT ====================
        function initAccountButton() {
            const savedClient = localStorage.getItem('hds_shop_client');
            if (savedClient) {
                currentClient = JSON.parse(savedClient);
                updateAccountButton(true);
            } else {
                updateAccountButton(false);
            }
        }
        
        function updateAccountButton(isConnected) {
            const button = document.getElementById('accountButton');
            if (isConnected) {
                button.classList.remove('disconnected');
                button.classList.add('connected');
                button.innerHTML = '<i class="fas fa-user-check"></i>';
            } else {
                button.classList.remove('connected');
                button.classList.add('disconnected');
                button.innerHTML = '<i class="fas fa-user"></i>';
            }
        }
        
        function openAccountModal() {
            const savedClient = localStorage.getItem('hds_shop_client');
            
            if (savedClient) {
                currentClient = JSON.parse(savedClient);
                showClientSection();
            } else {
                showLoginSection();
            }
            
            document.getElementById('accountModalOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function closeAccountModal() {
            document.getElementById('accountModalOverlay').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function showLoginSection() {
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('registerSection').style.display = 'none';
            document.getElementById('clientSection').style.display = 'none';
        }
        
        function showRegistration() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('registerSection').style.display = 'block';
            document.getElementById('clientSection').style.display = 'none';
        }
        
        function showClientSection() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('registerSection').style.display = 'none';
            document.getElementById('clientSection').style.display = 'block';
            
            // Mettre Ã  jour les infos client
            document.getElementById('clientName').textContent = currentClient.name;
            document.getElementById('clientPhone').textContent = currentClient.phone;
            document.getElementById('clientCodeDisplay').textContent = currentClient.code;
            document.getElementById('clientPoints').textContent = loyaltyPoints + ' pts';
            
            // Charger l'historique des commandes
            loadOrderHistory();
        }
        
        function loginClient() {
            const code = document.getElementById('clientCode').value;
            
            if (!code || code.length !== 4 || isNaN(code)) {
                showAlert('âŒ Code invalide. Entrez 4 chiffres.', 'error');
                return;
            }
            
            const savedClient = localStorage.getItem('hds_shop_client');
            
            if (savedClient) {
                const client = JSON.parse(savedClient);
                if (client.code === code) {
                    currentClient = client;
                    updateAccountButton(true);
                    showClientSection();
                    showAlert(`âœ… Bienvenue ${client.name} ! RÃ©duction de ${CLIENT_DISCOUNT}% activÃ©e.`);
                } else {
                    showAlert('âŒ Code incorrect.', 'error');
                }
            } else {
                showAlert('âŒ Aucun compte trouvÃ©. Inscrivez-vous.', 'error');
            }
        }
        
        function registerClient() {
            const name = document.getElementById('registerName').value;
            const phone = document.getElementById('registerPhone').value;
            const code = document.getElementById('registerCode').value;
            
            if (!name || !phone || !code) {
                showAlert('âŒ Tous les champs sont requis.', 'error');
                return;
            }
            
            if (code.length !== 4 || isNaN(code)) {
                showAlert('âŒ Le code doit Ãªtre composÃ© de 4 chiffres.', 'error');
                return;
            }
            
            const client = {
                name: name,
                phone: phone,
                code: code,
                joined: new Date().toISOString(),
                orders: []
            };
            
            localStorage.setItem('hds_shop_client', JSON.stringify(client));
            currentClient = client;
            
            updateAccountButton(true);
            showClientSection();
            showAlert(`âœ… Compte crÃ©Ã© ! Bienvenue ${name}. Profitez de -${CLIENT_DISCOUNT}% sur toutes vos commandes.`);
        }
        
        function logoutClient() {
            currentClient = null;
            localStorage.removeItem('hds_shop_client');
            
            updateAccountButton(false);
            showLoginSection();
            showAlert('ðŸ‘‹ DÃ©connexion rÃ©ussie.');
        }
        
        function loadOrderHistory() {
            const orderHistory = document.getElementById('orderHistory');
            
            if (!currentClient || !currentClient.orders || currentClient.orders.length === 0) {
                orderHistory.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: var(--gray-500);">
                        <div style="font-size: 40px; margin-bottom: 10px;">ðŸ“¦</div>
                        <div style="font-weight: 600; margin-bottom: 5px;">Aucune commande</div>
                        <div style="font-size: 13px;">Votre historique de commandes apparaÃ®tra ici</div>
                    </div>
                `;
                return;
            }
            
            let historyHTML = '';
            currentClient.orders.forEach((order, index) => {
                historyHTML += `
                    <div class="history-item">
                        <div class="history-date">${new Date(order.date).toLocaleDateString('fr-FR')} â€¢ Commande #${order.code}</div>
                        <div style="font-size: 14px; color: var(--gray-300); margin-bottom: 5px;">${order.items} articles</div>
                        <div class="history-total">${order.total}</div>
                    </div>
                `;
            });
            
            orderHistory.innerHTML = historyHTML;
        }
        
        function addOrderToHistory(orderDetails) {
            if (!currentClient) return;
            
            if (!currentClient.orders) {
                currentClient.orders = [];
            }
            
            currentClient.orders.unshift({
                date: new Date().toISOString(),
                code: orderDetails.code || 'CMD-' + Math.floor(10000 + Math.random() * 90000),
                items: orderDetails.items || cart.reduce((sum, item) => sum + item.quantity, 0),
                total: orderDetails.total || '0â‚¬'
            });
            
            // Garder seulement les 10 derniÃ¨res commandes
            if (currentClient.orders.length > 10) {
                currentClient.orders = currentClient.orders.slice(0, 10);
            }
            
            localStorage.setItem('hds_shop_client', JSON.stringify(currentClient));
            
            // Ajouter des points de fidÃ©litÃ©
            const pointsEarned = Math.floor(parseFloat(orderDetails.total) || 0);
            addLoyaltyPoints(pointsEarned);
        }
        
        // ==================== PAYPAL INTEGRATION ====================
        function initPayPal() {
            // Ã‰couter les changements de mÃ©thode de paiement
            document.querySelectorAll('input[name="paiement"], input[name="paiement_evenement"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const hasEvent = cartContainsEvent();
                    const containerId = hasEvent ? 'paypal-event-button-container' : 'paypal-button-container';
                    
                    if ((this.value === 'Carte Bancaire' || this.value === 'carte') && this.checked) {
                        document.getElementById(containerId).style.display = 'block';
                        renderPayPalButton(containerId);
                    } else {
                        document.getElementById(containerId).style.display = 'none';
                    }
                });
            });
        }
        
        function renderPayPalButton(containerId) {
            // Nettoyer le conteneur
            document.getElementById(containerId).innerHTML = '';
            
            // Calculer le total
            let subtotal = calculateSubtotal();
            let discount = calculateClientDiscount(subtotal);
            let total = subtotal - discount;
            
            // Dans un vrai site, tu utiliserais ton vrai client-id PayPal
            // Pour l'instant, simulation
            document.getElementById(containerId).innerHTML = `
                <div style="background: rgba(255,255,255,0.05); border-radius: var(--radius-md); padding: 15px; text-align: center;">
                    <div style="font-size: 14px; color: var(--gray-300); margin-bottom: 10px;">
                        <i class="fab fa-paypal" style="color: #003087; font-size: 20px; margin-right: 8px;"></i>
                        Paiement PayPal sÃ©curisÃ©
                    </div>
                    <div style="font-size: 12px; color: var(--gray-400); margin-bottom: 10px;">
                        Total Ã  payer: <span style="color: var(--primary-yellow); font-weight: 700;">${total.toFixed(2)}â‚¬</span>
                    </div>
                    <button class="checkout-button" onclick="processPayPalPayment()" style="background: linear-gradient(135deg, #003087, #009CDE);">
                        <i class="fab fa-paypal"></i>
                        Payer avec PayPal
                    </button>
                    <div style="font-size: 10px; color: var(--gray-500); margin-top: 10px;">
                        Paiement 100% sÃ©curisÃ© â€¢ Aucune information bancaire stockÃ©e
                    </div>
                </div>
            `;
        }
        
        function processPayPalPayment() {
            // Simulation de paiement PayPal rÃ©ussi
            showAlert('âœ… Paiement PayPal acceptÃ© !', 'success');
            
            // Cacher le bouton PayPal
            const hasEvent = cartContainsEvent();
            const containerId = hasEvent ? 'paypal-event-button-container' : 'paypal-button-container';
            document.getElementById(containerId).style.display = 'none';
            
            // Cocher espÃ¨ces pour continuer le processus normal
            const cashId = hasEvent ? 'cash_event' : 'cash';
            document.getElementById(cashId).checked = true;
        }
        
        // ==================== TABLEAU DE PRIX DYNAMIQUE ====================
        function updateEventPricing() {
            const eventType = document.querySelector('select[name="type_evenement"]').value;
            const pricingTable = document.getElementById('eventPricingTable');
            
            if (eventType) {
                pricingTable.style.display = 'block';
                calculateEventPrice();
            } else {
                pricingTable.style.display = 'none';
            }
        }
        
        function calculateEventPrice() {
            const personCount = parseInt(document.getElementById('personCount').value) || 10;
            let basePrice = 150;
            let extraPerPerson = 10;
            let basePersons = 10;
            
            // Ajuster selon le type d'Ã©vÃ©nement
            const eventType = document.querySelector('select[name="type_evenement"]').value;
            switch(eventType) {
                case 'anniversaire_enfant':
                    basePrice = 150;
                    extraPerPerson = 10;
                    basePersons = 10;
                    break;
                case 'anniversaire_ado':
                    basePrice = 250;
                    extraPerPerson = 15;
                    basePersons = 15;
                    break;
                case 'anniversaire_adultes':
                    basePrice = 350;
                    extraPerPerson = 15;
                    basePersons = 20;
                    break;
                case 'soiree_entreprise':
                    basePrice = 500;
                    extraPerPerson = 20;
                    basePersons = 30;
                    break;
                case 'mariage':
                    basePrice = 1200;
                    extraPerPerson = 50;
                    basePersons = 50;
                    break;
                case 'soiree_privee':
                    basePrice = 400;
                    extraPerPerson = 15;
                    basePersons = 25;
                    break;
                case 'baby_shower':
                    basePrice = 200;
                    extraPerPerson = 10;
                    basePersons = 15;
                    break;
                case 'evenement_pro':
                    basePrice = 800;
                    extraPerPerson = 25;
                    basePersons = 50;
                    break;
            }
            
            let totalPrice = basePrice;
            if (personCount > basePersons) {
                totalPrice += (personCount - basePersons) * extraPerPerson;
            }
            
            document.getElementById('estimatedPrice').textContent = totalPrice + 'â‚¬';
            
            // Mettre Ã  jour le prix dans le panier si un Ã©vÃ©nement est sÃ©lectionnÃ©
            updateEventInCart(eventType, personCount, totalPrice);
        }
        
        function updateEventInCart(eventType, personCount, totalPrice) {
            // Chercher si un Ã©vÃ©nement est dÃ©jÃ  dans le panier
            const eventIndex = cart.findIndex(item => {
                const product = products.find(p => p.id === item.id);
                return product && product.category === 'evenements';
            });
            
            if (eventIndex !== -1) {
                // Mettre Ã  jour l'Ã©vÃ©nement existant
                cart[eventIndex].price = totalPrice;
                cart[eventIndex].quantity = 1;
                cart[eventIndex].personCount = personCount;
                updateCart();
            }
        }
        
        function calculateDetailPrice() {
            if (!currentProductDetail || currentProductDetail.category !== 'evenements') return;
            
            const personCount = parseInt(document.getElementById('detailPersonCount').value) || currentProductDetail.pricing.basePersons;
            const basePrice = currentProductDetail.pricing.base;
            const extraPerPerson = currentProductDetail.pricing.extraPerPerson;
            const basePersons = currentProductDetail.pricing.basePersons;
            
            let totalPrice = basePrice;
            if (personCount > basePersons) {
                totalPrice += (personCount - basePersons) * extraPerPerson;
            }
            
            document.getElementById('detailEstimatedPrice').textContent = totalPrice + 'â‚¬';
            document.getElementById('priceBase').textContent = basePrice + 'â‚¬';
            document.getElementById('priceExtra').textContent = extraPerPerson + 'â‚¬/pers';
        }
        
        // ==================== FONCTIONS CARTE ====================
        function initDeliveryMap() {
            try {
                if (!document.getElementById('deliveryMap')) return;
                
                if (deliveryMap) deliveryMap.remove();
                
                // Vue plus large sur Marseille
                const marseille = [43.2965, 5.3698];
                deliveryMap = L.map('deliveryMap').setView(marseille, 11);
                
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: 'Â© OpenStreetMap',
                    maxZoom: 18
                }).addTo(deliveryMap);
                
                // Ajouter le marqueur du magasin
                L.marker(SHOP_LOCATION)
                    .addTo(deliveryMap)
                    .bindPopup(`
                        <b>H.D.S SHOP Ã‰vÃ©nements</b><br>
                        <small>ðŸ“ 134 avenue de Saint-Antoine</small>
                    `)
                    .openPopup();
                
                // Ajouter les zones de livraison
                addDeliveryZones();
                
                // Charger la localisation prÃ©cÃ©dente si elle existe
                const savedLocation = localStorage.getItem('hds_shop_user_location');
                if (savedLocation) {
                    const location = JSON.parse(savedLocation);
                    if (Date.now() - location.timestamp < 24 * 60 * 60 * 1000) { // 24 heures
                        userLocation = [location.lat, location.lng];
                        isUserLocated = true;
                        
                        // Ajouter le marqueur utilisateur
                        userMarker = L.marker([location.lat, location.lng], {
                            icon: L.divIcon({
                                html: '<div style="background: #2196F3; width: 40px; height: 40px; border-radius: 50%; border: 3px solid white; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 20px rgba(33, 150, 243, 0.7);"><i class="fas fa-user" style="color: white; font-size: 18px;"></i></div>',
                                iconSize: [40, 40],
                                iconAnchor: [20, 40],
                                className: 'user-marker'
                            })
                        }).addTo(deliveryMap);
                        
                        // Tracer une ligne
                        L.polyline([SHOP_LOCATION, [location.lat, location.lng]], {
                            color: '#2196F3',
                            weight: 3,
                            opacity: 0.7,
                            dashArray: '10, 10'
                        }).addTo(deliveryMap);
                        
                        // Mettre Ã  jour l'affichage
                        document.getElementById('distanceDisplay').style.display = 'block';
                        document.getElementById('distanceText').innerHTML = `<strong>${location.distance.toFixed(1)} km</strong> du magasin â€¢ ${location.zone}`;
                        
                        const button = document.getElementById('locateMeButton');
                        button.innerHTML = '<i class="fas fa-check"></i> LocalisÃ©';
                        button.style.background = 'linear-gradient(135deg, #4CAF50, #2E7D32)';
                    }
                }
                
                setTimeout(() => {
                    if (deliveryMap) deliveryMap.invalidateSize();
                }, 100);
                
            } catch (error) {
                console.error('Erreur carte:', error);
            }
        }
        
        function addDeliveryZones() {
            // Zone 1: Centre-ville (0-2km) - Gratuite Ã  partir de 50â‚¬
            L.circle([43.2965, 5.3698], {
                color: '#4CAF50',
                fillColor: '#4CAF50',
                fillOpacity: 0.2,
                radius: 2000
            }).addTo(deliveryMap).bindPopup('ðŸŸ¢ Zone Centre<br>0-2km â€¢ Gratuite Ã  50â‚¬');
            
            // Zone 2: Proche banlieue (2-5km)
            L.circle([43.2800, 5.3800], {
                color: '#FF9800',
                fillColor: '#FF9800',
                fillOpacity: 0.2,
                radius: 3000
            }).addTo(deliveryMap).bindPopup('ðŸŸ  Zone Proche<br>2-5km â€¢ 2-3â‚¬ supplÃ©ment');
            
            // Zone 3: Banlieue moyenne (5-10km)
            L.circle([43.3100, 5.4000], {
                color: '#9C27B0',
                fillColor: '#9C27B0',
                fillOpacity: 0.2,
                radius: 4000
            }).addTo(deliveryMap).bindPopup('ðŸŸ£ Zone Moyenne<br>5-10km â€¢ 4-5â‚¬ supplÃ©ment');
            
            // Zone 4: Loin (10+ km)
            L.circle([43.3500, 5.4500], {
                color: '#2196F3',
                fillColor: '#2196F3',
                fillOpacity: 0.2,
                radius: 5000
            }).addTo(deliveryMap).bindPopup('ðŸ”µ Zone Ã‰loignÃ©e<br>10+ km â€¢ 6-8â‚¬ supplÃ©ment');
        }
        
        // ==================== STORIES SNAPCHAT STYLE AVEC VOS VIDÃ‰OS ====================
        function openStories() {
            document.getElementById('storiesModalOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // RÃ©initialiser l'index
            currentStoryIndex = 1;
            
            // RÃ©initialiser toutes les slides
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`storySlide${i}`).style.display = 'none';
            }
            document.getElementById('storySlide1').style.display = 'block';
            
            // DÃ©marrer la progression de la premiÃ¨re story
            startStoryProgress(currentStoryIndex);
            
            // Pause toutes les vidÃ©os
            pauseAllVideos();
            
            // Jouer la premiÃ¨re vidÃ©o
            const firstVideo = document.querySelector('#storySlide1 video');
            if (firstVideo) {
                firstVideo.currentTime = 0;
                firstVideo.play().catch(e => console.log("Autoplay bloquÃ©, l'utilisateur devra cliquer", e));
            }
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function closeStories() {
            document.getElementById('storiesModalOverlay').classList.remove('active');
            document.body.style.overflow = 'auto';
            
            // ArrÃªter tous les timers
            if (storyTimer) {
                clearInterval(storyTimer);
                storyTimer = null;
            }
            
            // ArrÃªter toutes les vidÃ©os
            pauseAllVideos();
        }
        
        function nextStory() {
            if (currentStoryIndex < 5) {
                // Cacher la slide actuelle
                document.getElementById(`storySlide${currentStoryIndex}`).style.display = 'none';
                
                // Passer Ã  la suivante
                currentStoryIndex++;
                
                // Afficher la nouvelle slide
                document.getElementById(`storySlide${currentStoryIndex}`).style.display = 'block';
                
                // Jouer la vidÃ©o
                const currentVideo = document.querySelector(`#storySlide${currentStoryIndex} video`);
                if (currentVideo) {
                    currentVideo.currentTime = 0;
                    currentVideo.play().catch(e => console.log("Autoplay bloquÃ©", e));
                }
                
                // DÃ©marrer la progression pour cette story
                startStoryProgress(currentStoryIndex);
            } else {
                // Fin des stories, fermer
                closeStories();
            }
        }
        
        function prevStory() {
            if (currentStoryIndex > 1) {
                // Cacher la slide actuelle
                document.getElementById(`storySlide${currentStoryIndex}`).style.display = 'none';
                
                // Passer Ã  la prÃ©cÃ©dente
                currentStoryIndex--;
                
                // Afficher la nouvelle slide
                document.getElementById(`storySlide${currentStoryIndex}`).style.display = 'block';
                
                // Jouer la vidÃ©o
                const currentVideo = document.querySelector(`#storySlide${currentStoryIndex} video`);
                if (currentVideo) {
                    currentVideo.currentTime = 0;
                    currentVideo.play().catch(e => console.log("Autoplay bloquÃ©", e));
                }
                
                // DÃ©marrer la progression pour cette story
                startStoryProgress(currentStoryIndex);
            }
        }
        
        function pauseAllVideos() {
            for (let i = 1; i <= 5; i++) {
                const video = document.querySelector(`#storySlide${i} video`);
                if (video) {
                    video.pause();
                }
            }
        }
        
        function startStoryProgress(storyIndex) {
            // ArrÃªter le timer prÃ©cÃ©dent
            if (storyTimer) {
                clearInterval(storyTimer);
                storyTimer = null;
            }
            
            // RÃ©initialiser la progression de toutes les barres
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`storyProgress${i}`).style.width = '0%';
                document.getElementById(`storyProgress${i}`).classList.remove('active');
            }
            
            let progress = 0;
            const totalTime = 10; // 10 secondes par story
            const interval = 50; // Mise Ã  jour toutes les 50ms
            
            document.getElementById(`storyProgress${storyIndex}`).classList.add('active');
            
            storyTimer = setInterval(() => {
                progress += (interval / (totalTime * 1000)) * 100;
                if (progress <= 100) {
                    document.getElementById(`storyProgress${storyIndex}`).style.width = progress + '%';
                } else {
                    // Passer Ã  la story suivante
                    clearInterval(storyTimer);
                    storyTimer = null;
                    
                    if (storyIndex < 5) {
                        nextStory();
                    } else {
                        closeStories();
                    }
                }
            }, interval);
        }
        
        // ==================== FONCTIONS PRODUITS ====================
        function openProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            currentProductDetail = product;
            
            document.getElementById('detailProductImage').src = product.image;
            document.getElementById('detailProductName').textContent = product.name;
            
            // Afficher le prix avec rÃ©duction si client
            const discountedPrice = currentClient && product.category !== 'evenements' ? 
                product.price * (1 - CLIENT_DISCOUNT / 100) : product.price;
            
            if (currentClient && product.category !== 'evenements') {
                document.getElementById('detailProductPrice').innerHTML = `
                    <span style="text-decoration: line-through; color: var(--gray-500); margin-right: 8px;">${product.price.toFixed(2)}â‚¬</span>
                    <span style="color: var(--primary-yellow);">${discountedPrice.toFixed(2)}â‚¬</span>
                    <span class="client-badge">-${CLIENT_DISCOUNT}%</span>
                `;
            } else {
                document.getElementById('detailProductPrice').textContent = product.price.toFixed(2) + 'â‚¬';
            }
            
            document.getElementById('detailProductDescription').textContent = product.description;
            
            // Afficher les spÃ©cifications
            const specsContainer = document.getElementById('detailProductSpecs');
            specsContainer.innerHTML = `
                <h4>ðŸ“‹ DÃ©tails du produit</h4>
                <ul>
                    ${product.specs ? product.specs.map(spec => `<li>${spec}</li>`).join('') : ''}
                    ${product.size ? `<li><strong>Taille/Format:</strong> ${product.size}</li>` : ''}
                    <li><strong>CatÃ©gorie:</strong> ${getCategoryLabel(product.category)}</li>
                    <li><strong>DisponibilitÃ©:</strong> ${product.available ? 'âœ… En stock' : 'âŒ Rupture'}</li>
                </ul>
            `;
            
            // Afficher le tableau de prix pour les Ã©vÃ©nements
            const pricingTable = document.getElementById('detailPricingTable');
            if (product.category === 'evenements' && product.pricing) {
                pricingTable.style.display = 'block';
                calculateDetailPrice();
            } else {
                pricingTable.style.display = 'none';
            }
            
            document.getElementById('detailQuantityInput').value = 1;
            document.getElementById('detailBuyButton').disabled = !product.available;
            document.getElementById('detailBuyButton').innerHTML = !product.available ? 'Indisponible' : 'Ajouter au panier';
            
            document.getElementById('productDetailModal').classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function closeProductDetail() {
            document.getElementById('productDetailModal').classList.remove('active');
            document.body.style.overflow = 'auto';
            currentProductDetail = null;
        }
        
        function detailIncrementQuantity() {
            const input = document.getElementById('detailQuantityInput');
            input.value = parseInt(input.value) + 1;
            input.style.transform = 'scale(1.1)';
            setTimeout(() => input.style.transform = 'scale(1)', 150);
        }
        
        function detailDecrementQuantity() {
            const input = document.getElementById('detailQuantityInput');
            if (parseInt(input.value) > 1) {
                input.value = parseInt(input.value) - 1;
                input.style.transform = 'scale(0.9)';
                setTimeout(() => input.style.transform = 'scale(1)', 150);
            }
        }
        
        function addToCartFromDetail() {
            if (!currentProductDetail || !currentProductDetail.available) {
                showAlert('âŒ Produit indisponible', 'error');
                return;
            }
            
            const quantity = parseInt(document.getElementById('detailQuantityInput').value);
            let price = currentProductDetail.price;
            
            // Appliquer la rÃ©duction client si applicable
            if (currentClient && currentProductDetail.category !== 'evenements') {
                price = price * (1 - CLIENT_DISCOUNT / 100);
            }
            
            // Pour les Ã©vÃ©nements, utiliser le prix calculÃ©
            if (currentProductDetail.category === 'evenements') {
                const personCount = parseInt(document.getElementById('detailPersonCount').value) || currentProductDetail.pricing.basePersons;
                const basePrice = currentProductDetail.pricing.base;
                const extraPerPerson = currentProductDetail.pricing.extraPerPerson;
                const basePersons = currentProductDetail.pricing.basePersons;
                
                price = basePrice;
                if (personCount > basePersons) {
                    price += (personCount - basePersons) * extraPerPerson;
                }
            }
            
            const existingItem = cart.find(item => item.id === currentProductDetail.id);
            
            if (existingItem) {
                existingItem.quantity += quantity;
                existingItem.price = price; // Mettre Ã  jour le prix au cas oÃ¹ il aurait changÃ©
            } else {
                cart.push({
                    id: currentProductDetail.id,
                    name: currentProductDetail.name,
                    price: price,
                    quantity: quantity,
                    category: currentProductDetail.category,
                    originalPrice: currentProductDetail.price
                });
            }
            
            updateCart();
            saveCartToStorage();
            
            const button = document.getElementById('detailBuyButton');
            button.innerHTML = '<i class="fas fa-check"></i> AjoutÃ©';
            button.style.background = 'linear-gradient(135deg, #4CAF50, #2E7D32)';
            
            setTimeout(() => {
                button.innerHTML = currentProductDetail.available ? 'Ajouter au panier' : 'Indisponible';
                button.style.background = currentProductDetail.available ? 
                    'linear-gradient(135deg, #4CAF50, #2E7D32)' : 
                    'var(--gray-600)';
            }, 1500);
            
            showAlert(`âœ… ${quantity} ${currentProductDetail.name} ajoutÃ©(s) !`);
            closeProductDetail();
        }
        
        function getCategoryLabel(category) {
            const labels = {
                'evenements': 'ðŸŽŠ Ã‰vÃ©nement',
                'repas': 'ðŸ½ï¸ Repas',
                'catering': 'ðŸ‘¨â€ðŸ³ Catering',
                'alimentation': 'ðŸ¥— Alimentation',
                'boissons': 'ðŸ¥¤ Boisson',
                'alcools': 'ðŸ¾ Alcool',
                'accessoires': 'ðŸ”Œ Accessoire'
            };
            return labels[category] || category;
        }

        // ==================== FONCTIONS PANIER ====================
        function calculateSubtotal() {
            return cart.reduce((total, item) => {
                return total + (item.price * item.quantity);
            }, 0);
        }
        
        function calculateClientDiscount(subtotal) {
            if (!currentClient) return 0;
            
            // Ne pas appliquer la rÃ©duction sur les Ã©vÃ©nements
            const nonEventSubtotal = cart.reduce((total, item) => {
                const product = products.find(p => p.id === item.id);
                if (product && product.category !== 'evenements') {
                    return total + (item.originalPrice || item.price) * item.quantity;
                }
                return total;
            }, 0);
            
            return nonEventSubtotal * (CLIENT_DISCOUNT / 100);
        }
        
        function addToCartWithQuantity(productId, button) {
            const product = products.find(p => p.id === productId);
            if (!product || !product.available) {
                showAlert('âŒ Produit indisponible', 'error');
                return;
            }
            
            const productElement = button.closest('.product-card');
            const quantity = parseInt(productElement.querySelector('.quantity-input').value);
            let price = product.price;
            
            // Appliquer la rÃ©duction client si applicable
            if (currentClient && product.category !== 'evenements') {
                price = price * (1 - CLIENT_DISCOUNT / 100);
            }
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += quantity;
                existingItem.price = price; // Mettre Ã  jour le prix
            } else {
                cart.push({
                    id: productId,
                    name: product.name,
                    price: price,
                    quantity: quantity,
                    category: product.category,
                    originalPrice: product.price
                });
            }
            
            updateCart();
            saveCartToStorage();
            
            button.innerHTML = '<i class="fas fa-check"></i> AjoutÃ©';
            button.style.background = 'linear-gradient(135deg, #4CAF50, #2E7D32)';
            
            setTimeout(() => {
                button.innerHTML = product.available ? 'Ajouter' : 'Indisponible';
                button.style.background = product.available ? 
                    'linear-gradient(135deg, #4CAF50, #2E7D32)' : 
                    'var(--gray-600)';
            }, 1500);
            
            showAlert(`âœ… ${quantity} ${product.name} ajoutÃ©(s) !`);
        }
        
        function updateCart() {
            const cartItems = document.getElementById('cartItems');
            const cartCount = document.getElementById('cartCount');
            const subtotalEl = document.getElementById('subtotal');
            const cartTotal = document.getElementById('cartTotal');
            const deliveryCostEl = document.getElementById('deliveryCost');
            const clientDiscountEl = document.getElementById('clientDiscount');
            
            if (!cartItems || !cartCount) return;
            
            cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: var(--gray-500);">
                        <div style="font-size: 40px; margin-bottom: 10px;">ðŸ›’</div>
                        <div style="font-weight: 600; margin-bottom: 5px;">Panier vide</div>
                        <div style="font-size: 13px;">Ajoutez des produits ou un Ã©vÃ©nement</div>
                    </div>
                `;
                cartCount.textContent = '0';
                if (subtotalEl) subtotalEl.textContent = '0â‚¬';
                if (cartTotal) cartTotal.textContent = 'Total : 0â‚¬';
                if (deliveryCostEl) deliveryCostEl.textContent = 'Gratuit';
                if (clientDiscountEl) clientDiscountEl.textContent = '0â‚¬';
                
                // Mettre Ã  jour le menu
                updateMenuDisplay();
                return;
            }
            
            let subtotal = 0;
            let itemsHTML = '';
            
            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                
                itemsHTML += `
                    <div class="cart-item">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-quantity">${item.quantity}x</div>
                        <div class="cart-item-price">${itemTotal.toFixed(2)}â‚¬</div>
                        <button class="cart-item-remove" onclick="removeFromCart(${index})">Ã—</button>
                    </div>
                `;
            });
            
            cartItems.innerHTML = itemsHTML;
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            const discount = calculateClientDiscount(subtotal);
            const deliveryCost = subtotal >= 50 ? 0 : 5; // Gratuit Ã  partir de 50â‚¬
            const totalWithEverything = subtotal - discount + deliveryCost;
            
            if (subtotalEl) subtotalEl.textContent = subtotal.toFixed(2) + 'â‚¬';
            if (clientDiscountEl) {
                clientDiscountEl.textContent = discount > 0 ? `-${discount.toFixed(2)}â‚¬` : '0â‚¬';
                clientDiscountEl.style.color = discount > 0 ? '#4CAF50' : 'var(--gray-400)';
            }
            if (cartTotal) cartTotal.textContent = `Total : ${totalWithEverything.toFixed(2)}â‚¬`;
            if (deliveryCostEl) {
                if (deliveryCost === 0) {
                    deliveryCostEl.textContent = 'Gratuit';
                    deliveryCostEl.style.color = '#4CAF50';
                } else {
                    deliveryCostEl.textContent = deliveryCost + 'â‚¬';
                    deliveryCostEl.style.color = 'var(--primary-yellow)';
                }
            }
            
            updateFormHiddenFields(subtotal, totalWithEverything, deliveryCost, totalItems, discount);
            
            // Mettre Ã  jour le menu
            updateMenuDisplay();
        }
        
        function updateFormHiddenFields(subtotal, total, deliveryCost, totalItems, discount) {
            const orderDetails = cart.map(item => 
                `${item.quantity}x ${item.name} - ${item.price.toFixed(2)}â‚¬ = ${(item.price * item.quantity).toFixed(2)}â‚¬`
            ).join('\n');
            
            document.getElementById('orderDetails').value = orderDetails;
            document.getElementById('totalOrderInput').value = total.toFixed(2) + 'â‚¬';
            document.getElementById('deliveryFeeInput').value = deliveryCost + 'â‚¬';
            document.getElementById('itemCountInput').value = totalItems;
            document.getElementById('clientDiscountInput').value = discount.toFixed(2) + 'â‚¬';
        }
        
        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCart();
            saveCartToStorage();
            showAlert('ðŸ—‘ï¸ Produit retirÃ©');
        }
        
        function checkout() {
            if (cart.length === 0) {
                showAlert('ðŸ›’ Panier vide !', 'error');
                return;
            }
            
            closeCart();
            setTimeout(() => {
                document.getElementById('checkoutModalOverlay').classList.add('active');
                document.body.style.overflow = 'hidden';
                
                // Mettre Ã  jour le formulaire selon le type de commande
                updateCheckoutForm();
                
                // Afficher le tableau de prix si un Ã©vÃ©nement est sÃ©lectionnÃ©
                const eventType = document.querySelector('select[name="type_evenement"]').value;
                if (eventType) {
                    document.getElementById('eventPricingTable').style.display = 'block';
                    calculateEventPrice();
                }
            }, 300);
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function submitOrder() {
            const confirmationCode = Math.floor(1000 + Math.random() * 9000).toString();
            currentConfirmationCode = confirmationCode;
            document.getElementById('confirmationCodeInput').value = confirmationCode;
            document.getElementById('confirmationCode').textContent = confirmationCode;
            
            const drivers = ['Mohamed (06 12 34 56 78)', 'Karim (06 87 65 43 21)', 'Ahmed (06 98 76 54 32)'];
            const times = ['25-35 minutes', '30-40 minutes', '35-45 minutes'];
            
            document.getElementById('deliveryTimeEstimate').textContent = times[Math.floor(Math.random() * times.length)];
            document.getElementById('deliveryDriver').textContent = drivers[Math.floor(Math.random() * drivers.length)];
            
            closeCheckout();
            setTimeout(() => {
                document.getElementById('confirmationModalOverlay').classList.add('active');
                document.body.style.overflow = 'hidden';
            }, 300);
        }
        
        function validateAndCloseConfirmation() {
            // 1. Calculer les frais rÃ©els avec l'adresse et type d'Ã©vÃ©nement
            const hasEvent = cartContainsEvent();
            const addressInput = hasEvent ? 
                document.querySelector('textarea[name="adresse_evenement"]') : 
                document.querySelector('textarea[name="adresse"]');
            const eventTypeSelect = document.querySelector('select[name="type_evenement"]');
            
            const userAddress = addressInput ? addressInput.value : "Marseille";
            const eventType = eventTypeSelect ? eventTypeSelect.value : 'none';
            
            let subtotal = calculateSubtotal();
            const discount = calculateClientDiscount(subtotal);
            const deliveryCost = subtotal >= 50 ? 0 : 5; // SimplifiÃ© pour l'exemple
            const totalWithDelivery = subtotal - discount + deliveryCost;
            
            // 2. Mettre Ã  jour les champs cachÃ©s avec les vraies infos
            document.getElementById('totalOrderInput').value = totalWithDelivery.toFixed(2) + 'â‚¬';
            document.getElementById('deliveryFeeInput').value = deliveryCost + 'â‚¬';
            document.getElementById('clientDiscountInput').value = discount.toFixed(2) + 'â‚¬';
            
            // 3. ENVOYER Ã€ FORMSPREE
            document.getElementById('checkoutForm').submit();
            
            // 4. GÃ©nÃ©rer un code de commande unique
            currentOrderCode = 'HDS' + Math.floor(10000 + Math.random() * 90000);
            
            // 5. Sauvegarder les infos
            localStorage.setItem('hds_shop_order_confirmed', 'true');
            localStorage.setItem('hds_shop_order_code', currentOrderCode);
            localStorage.setItem('hds_shop_confirmation_code', currentConfirmationCode);
            
            // 6. Livreur alÃ©atoire
            const drivers = [
                {name: 'Mohamed', phone: '06 12 34 56 78'},
                {name: 'Karim', phone: '06 87 65 43 21'},
                {name: 'Ahmed', phone: '06 98 76 54 32'}
            ];
            
            const selectedDriver = drivers[Math.floor(Math.random() * drivers.length)];
            currentDriverName = selectedDriver.name;
            currentDriverPhone = selectedDriver.phone;
            
            // Ajuster le temps de livraison
            let estimatedTime = '30-40 minutes';
            if (hasEvent) {
                estimatedTime = 'PlanifiÃ© selon date';
            }
            currentDeliveryTime = estimatedTime;
            
            localStorage.setItem('hds_shop_driver_name', currentDriverName);
            localStorage.setItem('hds_shop_driver_phone', currentDriverPhone);
            localStorage.setItem('hds_shop_delivery_time', currentDeliveryTime);
            localStorage.setItem('hds_shop_event_type', eventType);
            localStorage.setItem('hds_shop_has_event', hasEvent.toString());
            
            // 7. Ajouter Ã  l'historique du client
            if (currentClient) {
                addOrderToHistory({
                    code: currentOrderCode,
                    items: cart.reduce((sum, item) => sum + item.quantity, 0),
                    total: totalWithDelivery.toFixed(2) + 'â‚¬'
                });
            }
            
            // 8. Ajouter des points de fidÃ©litÃ©
            const pointsEarned = Math.floor(totalWithDelivery);
            addLoyaltyPoints(pointsEarned);
            
            // 9. Vider le panier
            cart = [];
            updateCart();
            saveCartToStorage();
            
            // 10. Afficher le bouton de suivi
            document.getElementById('followDeliveryButton').style.display = 'block';
            document.getElementById('startTrackerButton').style.display = 'block';
            document.getElementById('progressTracker').style.display = 'block';
            
            // 11. Mettre Ã  jour le statut
            const hasEventBool = localStorage.getItem('hds_shop_has_event') === 'true';
            document.getElementById('deliveryStatus').textContent = hasEventBool ? 'Ã‰vÃ©nement planifiÃ©' : 'En route';
            document.getElementById('deliveryStatus').style.background = hasEventBool ? 'rgba(156,39,176,0.2)' : 'rgba(255, 152, 0, 0.2)';
            document.getElementById('deliveryStatus').style.color = hasEventBool ? '#9C27B0' : '#FF9800';
            document.getElementById('deliveryStatus').style.borderColor = hasEventBool ? 'rgba(156,39,176,0.3)' : 'rgba(255, 152, 0, 0.3)';
            
            if (hasEventBool) {
                document.getElementById('driverETA').textContent = `ðŸŽŠ Ã‰vÃ©nement planifiÃ© â€¢ ${getEventLabel(eventType)}`;
            } else {
                document.getElementById('driverETA').textContent = `ðŸ“ ETA: ${currentDeliveryTime}`;
            }
            
            // 12. Fermer le modal
            closeConfirmation();
            
            // 13. Afficher notification
            let feeMessage = deliveryCost === 0 ? 'Livraison gratuite' : `Frais: ${deliveryCost}â‚¬`;
            let discountMessage = discount > 0 ? ` â€¢ Ã‰conomie: ${discount.toFixed(2)}â‚¬` : '';
            let eventMessage = hasEventBool ? ` â€¢ Ã‰vÃ©nement: ${getEventLabel(eventType)}` : '';
            let pointsMessage = ` â€¢ Points: +${pointsEarned}`;
            showAlert(`âœ… Commande confirmÃ©e ! Code: ${currentConfirmationCode} â€¢ ${feeMessage}${discountMessage}${eventMessage}${pointsMessage}`);
        }
        
        function getEventLabel(eventType) {
            const labels = {
                'anniversaire_enfant': 'Anniversaire Enfant',
                'anniversaire_ado': 'Anniversaire Ado',
                'anniversaire_adultes': 'Anniversaire Adultes',
                'soiree_entreprise': 'SoirÃ©e Entreprise',
                'mariage': 'Mariage',
                'soiree_privee': 'SoirÃ©e PrivÃ©e',
                'baby_shower': 'Baby Shower',
                'evenement_pro': 'Ã‰vÃ©nement Pro'
            };
            return labels[eventType] || eventType;
        }

        // ==================== FONCTIONS SUIVI AVEC BARRE DE PROGRESSION ====================
        function openDeliveryTrackerModal() {
            document.getElementById('modalOrderCode').textContent = currentOrderCode;
            document.getElementById('modalConfirmationCode').textContent = currentConfirmationCode;
            document.getElementById('modalDriverName').textContent = currentDriverName;
            document.getElementById('modalDriverPhone').textContent = currentDriverPhone;
            document.getElementById('modalDeliveryTime').textContent = currentDeliveryTime;
            
            // RÃ©initialiser la barre de progression
            document.getElementById('modalProgressBar').style.width = '0%';
            document.getElementById('modalProgressPercentage').textContent = '0%';
            
            document.getElementById('deliveryTrackerModalOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function closeDeliveryTrackerModal() {
            document.getElementById('deliveryTrackerModalOverlay').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function startRealisticDeliveryTracker() {
            // ArrÃªter tout suivi en cours
            if (deliveryTrackingInterval) {
                clearInterval(deliveryTrackingInterval);
            }
            
            // RÃ©initialiser la progression
            currentDeliveryProgress = 0;
            
            // RÃ©initialiser les Ã©tapes
            const steps = ['step1', 'step2', 'step3', 'step4'];
            steps.forEach(step => {
                document.getElementById(step).className = 'step-icon';
                document.getElementById(step).innerHTML = step.charAt(step.length - 1);
                document.querySelector(`.step-label:nth-child(${step.charAt(step.length - 1)})`).className = 'step-label';
            });
            
            // Marquer la premiÃ¨re Ã©tape comme terminÃ©e
            document.getElementById('step1').className = 'step-icon completed';
            document.querySelector('.step-label:nth-child(1)').className = 'step-label completed';
            
            // DÃ©marrer le suivi
            deliveryTrackingInterval = setInterval(() => {
                currentDeliveryProgress += 0.5;
                if (currentDeliveryProgress > 100) {
                    currentDeliveryProgress = 100;
                    clearInterval(deliveryTrackingInterval);
                    
                    // Marquer toutes les Ã©tapes comme terminÃ©es
                    document.getElementById('step2').className = 'step-icon completed';
                    document.getElementById('step3').className = 'step-icon completed';
                    document.getElementById('step4').className = 'step-icon completed';
                    document.querySelector('.step-label:nth-child(2)').className = 'step-label completed';
                    document.querySelector('.step-label:nth-child(3)').className = 'step-label completed';
                    document.querySelector('.step-label:nth-child(4)').className = 'step-label completed';
                    
                    // Mettre Ã  jour le statut
                    document.getElementById('deliveryStatus').textContent = 'LivrÃ© !';
                    document.getElementById('deliveryStatus').style.background = 'rgba(76,175,80,0.2)';
                    document.getElementById('deliveryStatus').style.color = '#4CAF50';
                    document.getElementById('deliveryStatus').style.borderColor = 'rgba(76,175,80,0.3)';
                    document.getElementById('driverETA').textContent = 'âœ… Livraison terminÃ©e';
                    
                    // Cacher les boutons
                    document.getElementById('followDeliveryButton').style.display = 'none';
                    document.getElementById('startTrackerButton').style.display = 'none';
                    
                    // Notification
                    showAlert('âœ… Livraison effectuÃ©e ! Merci pour votre commande.');
                    
                    // Effacer les donnÃ©es de commande
                    localStorage.removeItem('hds_shop_order_confirmed');
                    localStorage.removeItem('hds_shop_order_code');
                    localStorage.removeItem('hds_shop_confirmation_code');
                    
                    return;
                }
                
                // Mettre Ã  jour la barre de progression
                document.getElementById('progressBar').style.width = currentDeliveryProgress + '%';
                document.getElementById('progressPercentage').textContent = Math.round(currentDeliveryProgress) + '%';
                
                // Mettre Ã  jour la barre dans le modal si ouvert
                if (document.getElementById('modalProgressBar')) {
                    document.getElementById('modalProgressBar').style.width = currentDeliveryProgress + '%';
                    document.getElementById('modalProgressPercentage').textContent = Math.round(currentDeliveryProgress) + '%';
                    
                    // Mettre Ã  jour le temps restant
                    const timeRemaining = Math.round((100 - currentDeliveryProgress) * 0.3);
                    document.getElementById('modalTimeRemaining').textContent = timeRemaining + ' min';
                    document.getElementById('estimatedTime').textContent = timeRemaining + ' min';
                }
                
                // Mettre Ã  jour les Ã©tapes
                if (currentDeliveryProgress >= 25 && currentDeliveryProgress < 50) {
                    document.getElementById('step2').className = 'step-icon active';
                    document.querySelector('.step-label:nth-child(2)').className = 'step-label active';
                    document.getElementById('deliveryStatus').textContent = 'En prÃ©paration';
                } else if (currentDeliveryProgress >= 50 && currentDeliveryProgress < 75) {
                    document.getElementById('step2').className = 'step-icon completed';
                    document.getElementById('step3').className = 'step-icon active';
                    document.querySelector('.step-label:nth-child(2)').className = 'step-label completed';
                    document.querySelector('.step-label:nth-child(3)').className = 'step-label active';
                    document.getElementById('deliveryStatus').textContent = 'En route';
                } else if (currentDeliveryProgress >= 75) {
                    document.getElementById('step3').className = 'step-icon completed';
                    document.getElementById('step4').className = 'step-icon active';
                    document.querySelector('.step-label:nth-child(3)').className = 'step-label completed';
                    document.querySelector('.step-label:nth-child(4)').className = 'step-label active';
                    document.getElementById('deliveryStatus').textContent = 'ArrivÃ©e imminente';
                }
                
            }, 300);
            
            // Fermer le modal du suivi s'il est ouvert
            closeDeliveryTrackerModal();
            
            // Afficher la section tracker
            scrollToSection('tracker');
            
            // Notification de dÃ©part
            showAlert('ðŸš— Suivi de livraison dÃ©marrÃ© !');
        }
        
        // ==================== Ã‰VÃ‰NEMENTS ====================
        function initEventListeners() {
            // Ã‰couteur pour le type d'Ã©vÃ©nement
            document.querySelector('select[name="type_evenement"]')?.addEventListener('change', updateEventPricing);
            
            // Ã‰couteurs pour les onglets de catÃ©gories dans la section produits
            document.querySelectorAll('.category-tab').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.category-tab').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    this.classList.add('active');
                    currentFilter = this.getAttribute('data-category');
                    renderProducts();
                });
            });
            
            document.getElementById('logoImage').addEventListener('click', function() {
                showImage(this.src);
            });
            
            document.getElementById('statusText').addEventListener('click', function() {
                const messages = [
                    'ðŸŽ‰ Organisation Ã‰vÃ©nements Marseille',
                    'â­ 4.9/5 â€¢ 500+ Ã©vÃ©nements',
                    'ðŸŽ¯ Ã‰vÃ©nements premium garantis',
                    'ðŸ” Service discret 24h/24',
                    'ðŸª Organisation complÃ¨te',
                    'ðŸ“± Suivi en temps rÃ©el',
                    'ðŸ½ï¸ Catering professionnel',
                    'ðŸŽŠ Anniversaires, mariages, soirÃ©es'
                ];
                const current = this.querySelector('.status-text').textContent;
                let newMessage;
                do {
                    newMessage = messages[Math.floor(Math.random() * messages.length)];
                } while (newMessage === current);
                
                this.querySelector('.status-text').textContent = newMessage;
            });
            
            document.getElementById('openCartButton').addEventListener('click', openCart);
            
            document.getElementById('cartModalOverlay').addEventListener('click', function(e) {
                if (e.target === this) closeCart();
            });
            
            document.getElementById('checkoutModalOverlay').addEventListener('click', function(e) {
                if (e.target === this) closeCheckout();
            });
            
            document.getElementById('confirmationModalOverlay').addEventListener('click', function(e) {
                if (e.target === this) closeConfirmation();
            });
            
            document.getElementById('storiesModalOverlay').addEventListener('click', function(e) {
                if (e.target === this) closeStories();
            });
            
            document.getElementById('productDetailModal').addEventListener('click', function(e) {
                if (e.target === this) closeProductDetail();
            });
            
            document.getElementById('accountModalOverlay').addEventListener('click', function(e) {
                if (e.target === this) closeAccountModal();
            });
            
            document.getElementById('deliveryTrackerModalOverlay').addEventListener('click', function(e) {
                if (e.target === this) closeDeliveryTrackerModal();
            });
            
            window.addEventListener('resize', function() {
                if (deliveryMap) {
                    setTimeout(() => deliveryMap.invalidateSize(), 100);
                }
            });
            
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') closeAllModals();
            });
            
            // Enregistrer l'activitÃ© de l'utilisateur
            document.addEventListener('click', function() {
                localStorage.setItem('hds_shop_last_activity', Date.now());
            });
            
            // Fermer le menu en cliquant Ã  l'extÃ©rieur
            document.addEventListener('click', function(e) {
                if (menuOpen && !document.getElementById('verticalMenu').contains(e.target) && 
                    !document.getElementById('menuButton').contains(e.target)) {
                    toggleMenu();
                }
            });
        }
        
        function checkActiveOrder() {
            if (localStorage.getItem('hds_shop_order_confirmed') === 'true') {
                document.getElementById('followDeliveryButton').style.display = 'block';
                document.getElementById('startTrackerButton').style.display = 'block';
                document.getElementById('progressTracker').style.display = 'block';
                
                currentOrderCode = localStorage.getItem('hds_shop_order_code') || 'CMD-' + Math.floor(10000 + Math.random() * 90000);
                currentConfirmationCode = localStorage.getItem('hds_shop_confirmation_code') || 'HDS-' + Math.floor(1000 + Math.random() * 9000);
                currentDriverName = localStorage.getItem('hds_shop_driver_name') || 'Mohamed';
                currentDriverPhone = localStorage.getItem('hds_shop_driver_phone') || '06 ** ** ** **';
                currentDeliveryTime = localStorage.getItem('hds_shop_delivery_time') || '35 minutes';
                
                // Mettre Ã  jour le statut
                const hasEvent = localStorage.getItem('hds_shop_has_event') === 'true';
                const eventType = localStorage.getItem('hds_shop_event_type');
                
                if (hasEvent) {
                    document.getElementById('deliveryStatus').textContent = 'Ã‰vÃ©nement planifiÃ©';
                    document.getElementById('deliveryStatus').style.background = 'rgba(156,39,176,0.2)';
                    document.getElementById('deliveryStatus').style.color = '#9C27B0';
                    document.getElementById('deliveryStatus').style.borderColor = 'rgba(156,39,176,0.3)';
                    document.getElementById('driverETA').textContent = `ðŸŽŠ Ã‰vÃ©nement planifiÃ© â€¢ ${getEventLabel(eventType)}`;
                } else {
                    document.getElementById('deliveryStatus').textContent = 'En route';
                    document.getElementById('driverETA').textContent = `ðŸ“ ETA: ${currentDeliveryTime}`;
                }
            }
        }
        
        function checkClientStatus() {
            const savedClient = localStorage.getItem('hds_shop_client');
            if (savedClient) {
                currentClient = JSON.parse(savedClient);
                updateAccountButton(true);
            }
        }

        // ==================== UTILITAIRES ====================
        function openCart() {
            document.getElementById('cartModalOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function closeCart() {
            document.getElementById('cartModalOverlay').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function closeCheckout() {
            document.getElementById('checkoutModalOverlay').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function closeConfirmation() {
            document.getElementById('confirmationModalOverlay').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function closeAllModals() {
            document.querySelectorAll('.modal-overlay.active').forEach(modal => {
                modal.classList.remove('active');
            });
            document.body.style.overflow = 'auto';
        }
        
        function incrementQuantity(button) {
            const input = button.parentElement.querySelector('.quantity-input');
            input.value = parseInt(input.value) + 1;
            input.style.transform = 'scale(1.1)';
            setTimeout(() => input.style.transform = 'scale(1)', 150);
        }
        
        function decrementQuantity(button) {
            const input = button.parentElement.querySelector('.quantity-input');
            if (parseInt(input.value) > 1) {
                input.value = parseInt(input.value) - 1;
                input.style.transform = 'scale(0.9)';
                setTimeout(() => input.style.transform = 'scale(1)', 150);
            }
        }
        
        function showAlert(message, type = 'success') {
            const alert = document.getElementById('alertModal');
            const messageEl = document.getElementById('alertMessage');
            
            if (!alert || !messageEl) return;
            
            messageEl.innerHTML = message;
            alert.style.background = type === 'error' ? 
                'linear-gradient(135deg, #FF5252, #FF1744)' : 
                type === 'warning' ?
                'linear-gradient(135deg, #FF9800, #FF5722)' :
                type === 'info' ?
                'linear-gradient(135deg, #2196F3, #1976D2)' :
                'linear-gradient(135deg, var(--primary-yellow), var(--accent-orange))';
            
            alert.style.display = 'flex';
            
            setTimeout(() => {
                alert.style.animation = 'slideOutUp 0.3s forwards';
                setTimeout(() => {
                    alert.style.display = 'none';
                    alert.style.animation = '';
                }, 300);
            }, 3000);
        }
        
        function showImage(src) {
            const modal = document.getElementById('imageModal');
            const img = document.getElementById('zoomedImage');
            img.src = src;
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        
        function closeImage() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function saveCartToStorage() {
            localStorage.setItem('hds_shop_cart', JSON.stringify(cart));
        }
        
        function loadCartFromStorage() {
            const saved = localStorage.getItem('hds_shop_cart');
            if (saved) {
                cart = JSON.parse(saved);
                updateCart();
            }
        }
        
        // ==================== NOUVELLES FONCTIONNALITÃ‰S ====================
        
        // Chat en direct
        function toggleChat() {
            const chatModal = document.getElementById('chatModal');
            chatOpen = !chatOpen;
            
            if (chatOpen) {
                chatModal.classList.add('active');
            } else {
                chatModal.classList.remove('active');
            }
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                const chatBody = document.getElementById('chatBody');
                
                // Message utilisateur
                const userMessage = document.createElement('div');
                userMessage.className = 'chat-message user';
                userMessage.textContent = message;
                chatBody.appendChild(userMessage);
                
                // RÃ©ponse automatique
                setTimeout(() => {
                    const responses = [
                        "Je comprends votre demande. Un conseiller vous rÃ©pondra dans quelques instants.",
                        "Merci pour votre message ! Nous traitons votre demande.",
                        "Pour une rÃ©ponse plus prÃ©cise, pouvez-vous prÃ©ciser votre demande ?",
                        "Nos conseillers sont actuellement occupÃ©s. Nous vous rÃ©pondrons rapidement.",
                        "Avez-vous besoin d'aide pour un Ã©vÃ©nement spÃ©cifique ?"
                    ];
                    
                    const botMessage = document.createElement('div');
                    botMessage.className = 'chat-message bot';
                    botMessage.textContent = responses[Math.floor(Math.random() * responses.length)];
                    chatBody.appendChild(botMessage);
                    
                    chatBody.scrollTop = chatBody.scrollHeight;
                }, 1000);
                
                input.value = '';
                chatBody.scrollTop = chatBody.scrollHeight;
            }
        }
        
        function handleChatInput(e) {
            if (e.key === 'Enter') {
                sendChatMessage();
            }
        }
        
        // Notifications push
        function initNotifications() {
            // Charger les notifications existantes
            const saved = localStorage.getItem('hds_shop_notifications');
            if (saved) {
                notifications = JSON.parse(saved);
                updateNotificationBell();
            }
            
            // Ajouter une notification de bienvenue
            addNotification('Bienvenue sur H.D.S SHOP ! ðŸŽ‰', 'Profitez de -5% sur votre premiÃ¨re commande avec le code BIENVENUE5');
            
            // Simuler des notifications pÃ©riodiques
            setInterval(() => {
                const promotions = [
                    {title: 'Offre SpÃ©ciale âš¡', message: 'Livraison gratuite ce week-end !'},
                    {title: 'Nouveau Produit ðŸŽŠ', message: 'DÃ©couvrez nos kits soirÃ©e premium'},
                    {title: 'Rappel ðŸ“…', message: 'Pensez Ã  rÃ©server vos Ã©vÃ©nements Ã  l\'avance'},
                    {title: 'Points FidÃ©litÃ© ðŸ†', message: 'Vous avez gagnÃ© 10 points !'}
                ];
                
                const randomPromo = promotions[Math.floor(Math.random() * promotions.length)];
                addNotification(randomPromo.title, randomPromo.message);
            }, 300000); // Toutes les 5 minutes
        }
        
        function addNotification(title, message) {
            const notification = {
                id: Date.now(),
                title: title,
                message: message,
                date: new Date().toLocaleString('fr-FR'),
                read: false
            };
            
            notifications.unshift(notification);
            if (notifications.length > 10) notifications.length = 10;
            
            localStorage.setItem('hds_shop_notifications', JSON.stringify(notifications));
            updateNotificationBell();
            updateMenuDisplay();
        }
        
        function updateNotificationBell() {
            const bell = document.getElementById('notificationBell');
            const unread = notifications.filter(n => !n.read).length;
            
            if (unread > 0) {
                bell.classList.add('has-notification');
            } else {
                bell.classList.remove('has-notification');
            }
        }
        
        function showNotifications() {
            let notificationHTML = '<h3 style="margin-bottom: 15px; color: var(--text-color);">Notifications</h3>';
            
            if (notifications.length === 0) {
                notificationHTML += '<p style="color: var(--gray-400); text-align: center; padding: 20px;">Aucune notification</p>';
            } else {
                notifications.forEach(notification => {
                    notificationHTML += `
                        <div style="background: rgba(255,255,255,0.05); border-radius: var(--radius-md); padding: 12px; margin-bottom: 10px; border-left: 3px solid ${notification.read ? 'var(--gray-500)' : 'var(--primary-yellow)'};">
                            <div style="font-weight: 700; color: var(--text-color); margin-bottom: 5px;">${notification.title}</div>
                            <div style="color: var(--gray-300); font-size: 12px;">${notification.message}</div>
                            <div style="color: var(--gray-500); font-size: 10px; margin-top: 5px;">${notification.date}</div>
                        </div>
                    `;
                    
                    // Marquer comme lu
                    notification.read = true;
                });
                
                localStorage.setItem('hds_shop_notifications', JSON.stringify(notifications));
                updateNotificationBell();
                updateMenuDisplay();
            }
            
            showAlert('ðŸ”” Notifications', 'info');
            
            // Afficher dans un modal simple
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: var(--card-bg);
                border-radius: var(--radius-xl);
                padding: 20px;
                max-width: 90%;
                width: 300px;
                max-height: 80vh;
                overflow-y: auto;
                z-index: 2100;
                border: 1px solid rgba(255,215,0,0.2);
                box-shadow: var(--shadow-xl);
            `;
            
            modal.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: var(--text-color);">ðŸ”” Notifications</h3>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: var(--text-color); font-size: 20px; cursor: pointer;">Ã—</button>
                </div>
                ${notificationHTML}
            `;
            
            document.body.appendChild(modal);
            
            // Fermer en cliquant Ã  l'extÃ©rieur
            setTimeout(() => {
                modal.onclick = function(e) {
                    if (e.target === modal) modal.remove();
                };
            }, 100);
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function checkForNotifications() {
            // VÃ©rifier si l'utilisateur est inactif pour envoyer une notification
            const lastActivity = localStorage.getItem('hds_shop_last_activity') || 0;
            const now = Date.now();
            
            if (now - lastActivity > 300000) { // 5 minutes d'inactivitÃ©
                const offers = [
                    "Ne manquez pas nos offres spÃ©ciales du week-end !",
                    "RÃ©servez votre Ã©vÃ©nement et obtenez 10% de rÃ©duction",
                    "Nouveaux produits disponibles dans la boutique"
                ];
                
                const randomOffer = offers[Math.floor(Math.random() * offers.length)];
                addNotification('Rappel H.D.S SHOP ðŸ“¢', randomOffer);
            }
        }
        
        // SystÃ¨me de fidÃ©litÃ©
        function loadLoyaltyData() {
            const saved = localStorage.getItem('hds_shop_loyalty');
            if (saved) {
                const data = JSON.parse(saved);
                loyaltyPoints = data.points || 0;
                referralCount = data.referrals || 0;
                referralEarnings = data.earnings || 0;
                updateLoyaltyDisplay();
            } else {
                // GÃ©nÃ©rer un code de parrainage alÃ©atoire
                localStorage.setItem('hds_shop_referral_code', 'HDS' + Math.floor(100 + Math.random() * 900));
            }
        }
        
        function updateLoyaltyDisplay() {
            // Ces fonctions sont maintenant gÃ©rÃ©es par updateMenuDisplay()
        }
        
        function addLoyaltyPoints(points) {
            loyaltyPoints += points;
            const data = {
                points: loyaltyPoints,
                referrals: referralCount,
                earnings: referralEarnings
            };
            localStorage.setItem('hds_shop_loyalty', JSON.stringify(data));
            updateMenuDisplay();
            
            // Ajouter une notification
            addNotification('Points FidÃ©litÃ© ðŸ†', `Vous avez gagnÃ© ${points} points !`);
        }
        
        function copyReferralCode() {
            const code = localStorage.getItem('hds_shop_referral_code') || 'HDS123';
            navigator.clipboard.writeText(code).then(() => {
                showAlert('âœ… Code copiÃ© dans le presse-papier !');
            });
        }
        
        // Galerie photos
        function initGallery() {
            const gallery = document.getElementById('eventGallery');
            if (gallery) {
                eventGallery.forEach((image, index) => {
                    const item = document.createElement('div');
                    item.className = 'gallery-item';
                    item.onclick = () => showImage(image);
                    
                    const img = document.createElement('img');
                    img.src = image;
                    img.alt = `Ã‰vÃ©nement ${index + 1}`;
                    img.loading = 'lazy';
                    
                    item.appendChild(img);
                    gallery.appendChild(item);
                });
            }
        }
        
        // Mode nuit/jour
        function initTheme() {
            const saved = localStorage.getItem('hds_shop_theme');
            if (saved === 'light') {
                toggleTheme();
            }
        }
        
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            if (isDarkMode) {
                document.body.classList.remove('light-mode');
                document.getElementById('themeIcon').className = 'fas fa-moon';
                document.getElementById('menuThemeIcon').className = 'fas fa-moon';
                document.getElementById('menuTheme').textContent = 'ON';
                localStorage.setItem('hds_shop_theme', 'dark');
            } else {
                document.body.classList.add('light-mode');
                document.getElementById('themeIcon').className = 'fas fa-sun';
                document.getElementById('menuThemeIcon').className = 'fas fa-sun';
                document.getElementById('menuTheme').textContent = 'OFF';
                localStorage.setItem('hds_shop_theme', 'light');
            }
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        // Traduction multilingue
        function toggleLanguage() {
            const languages = ['fr', 'en', 'ar'];
            const currentIndex = languages.indexOf(currentLanguage);
            const nextIndex = (currentIndex + 1) % languages.length;
            currentLanguage = languages[nextIndex];
            
            document.getElementById('langText').textContent = currentLanguage.toUpperCase();
            document.getElementById('menuLang').textContent = currentLanguage.toUpperCase();
            updateLanguage();
            localStorage.setItem('hds_shop_language', currentLanguage);
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function updateLanguage() {
            const translations = {
                fr: {
                    products: "Produits",
                    accessories: "Populaires",
                    events: "Ã‰vÃ©nements",
                    tracker: "Suivi",
                    info: "Infos"
                },
                en: {
                    products: "Products",
                    accessories: "Popular",
                    events: "Events",
                    tracker: "Tracking",
                    info: "Info"
                },
                ar: {
                    products: "Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
                    accessories: "Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ù‡Ø±Ø©",
                    events: "Ø§Ù„Ø£Ø­Ø¯Ø§Ø«",
                    tracker: "Ø§Ù„ØªØªØ¨Ø¹",
                    info: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª"
                }
            };
            
            const lang = translations[currentLanguage] || translations.fr;
            
            // Mettre Ã  jour les boutons de navigation
            const buttons = document.querySelectorAll('.quick-nav-btn span');
            if (buttons.length >= 5) {
                buttons[0].textContent = lang.products;
                buttons[1].textContent = lang.accessories;
                buttons[2].textContent = lang.events;
                buttons[3].textContent = lang.tracker;
                buttons[4].textContent = lang.info;
            }
        }
        
        // SystÃ¨me de rÃ©servation avec calendrier
        function initCalendar() {
            const calendarEl = document.getElementById('calendar');
            if (calendarEl) {
                calendar = new FullCalendar.Calendar(calendarEl, {
                    initialView: 'dayGridMonth',
                    locale: currentLanguage,
                    headerToolbar: {
                        left: 'prev,next today',
                        center: 'title',
                        right: 'dayGridMonth,timeGridWeek,timeGridDay'
                    },
                    events: [
                        {
                            title: 'ðŸŽ‚ Anniversaire Enfant',
                            start: new Date(),
                            end: new Date(new Date().setHours(new Date().getHours() + 3)),
                            color: '#FF9800'
                        },
                        {
                            title: 'ðŸ’¼ Ã‰vÃ©nement Entreprise',
                            start: new Date(new Date().setDate(new Date().getDate() + 2)),
                            end: new Date(new Date().setDate(new Date().getDate() + 2)),
                            color: '#2196F3'
                        },
                        {
                            title: 'ðŸŽ‰ SoirÃ©e PrivÃ©e',
                            start: new Date(new Date().setDate(new Date().getDate() + 5)),
                            end: new Date(new Date().setDate(new Date().getDate() + 5)),
                            color: '#9C27B0'
                        }
                    ],
                    eventClick: function(info) {
                        alert('Ã‰vÃ©nement: ' + info.event.title);
                    },
                    dateClick: function(info) {
                        openReservationModal(info.dateStr);
                    }
                });
                calendar.render();
            }
        }
        
        function openReservationModal(date) {
            document.getElementById('reservationModal').classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Fermer le menu si ouvert
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function closeReservationModal() {
            document.getElementById('reservationModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        function confirmReservation() {
            const eventType = document.getElementById('reservationEventType').value;
            showAlert('âœ… RÃ©servation confirmÃ©e pour ' + eventType);
            closeReservationModal();
        }
        
        // ==================== FONCTIONS MÃ‰TÃ‰O, FIDÃ‰LITÃ‰ ET PARRAINAGE DANS LE MENU ====================
        
        function showWeatherInfo() {
            showAlert(`ðŸŒ¤ï¸ MÃ©tÃ©o: 28Â°C â˜€ï¸<br>ðŸ’¨ Vent: 15 km/h<br>ðŸ’§ HumiditÃ©: 41%<br>ðŸŒ… Coucher: 20:59`, 'info');
            toggleMenu();
        }
        
        function showLoyaltyInfo() {
            const nextLevel = Math.ceil(loyaltyPoints / 100) * 100;
            const progress = (loyaltyPoints % 100);
            
            let html = `
                <div style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 152, 0, 0.2)); border-radius: var(--radius-lg); padding: 20px; margin: 20px 0; border: 1px solid rgba(255, 215, 0, 0.3);">
                    <div style="font-weight: 700; color: var(--text-color); margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-crown"></i>
                        Carte FidÃ©litÃ©
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div style="font-weight: 800; color: var(--primary-yellow); font-size: 24px;">${loyaltyPoints} pts</div>
                        <div style="font-weight: 600; color: var(--gray-300); font-size: 14px;">Prochain niveau: ${nextLevel} pts</div>
                    </div>
                    
                    <div class="loyalty-progress" style="margin: 15px 0;">
                        <div class="loyalty-progress-bar" style="width: ${progress}%"></div>
                    </div>
                    
                    <div class="loyalty-stats">
                        <div>0 pts</div>
                        <div>${loyaltyPoints % 100}/${100} pts</div>
                        <div>${nextLevel} pts</div>
                    </div>
                    
                    <div style="margin-top: 15px; font-size: 12px; color: var(--gray-300);">
                        â€¢ 1 point pour chaque euro dÃ©pensÃ©<br>
                        â€¢ 100 points = 10â‚¬ de rÃ©duction<br>
                        â€¢ Offres exclusives pour les membres
                    </div>
                </div>
            `;
            
            showCustomModal('ðŸŽ–ï¸ Carte FidÃ©litÃ©', html);
            toggleMenu();
        }
        
        function showReferralInfo() {
            const referralCode = localStorage.getItem('hds_shop_referral_code') || 'HDS123';
            
            let html = `
                <div style="background: linear-gradient(135deg, rgba(156, 39, 176, 0.2), rgba(103, 58, 183, 0.2)); border-radius: var(--radius-lg); padding: 20px; margin: 20px 0; border: 1px solid rgba(156, 39, 176, 0.3);">
                    <div style="font-weight: 700; color: var(--text-color); margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-user-friends"></i>
                        Programme de Parrainage
                    </div>
                    
                    <div style="font-size: 14px; color: var(--gray-300); margin-bottom: 20px;">
                        Recevez 10â‚¬ pour chaque ami qui commande avec votre code
                    </div>
                    
                    <div style="background: rgba(0, 0, 0, 0.3); border-radius: var(--radius-md); padding: 20px; text-align: center; margin: 15px 0; border: 2px dashed rgba(255, 255, 255, 0.3);">
                        <div style="font-size: 11px; color: var(--gray-400); margin-bottom: 5px;">Votre code de parrainage</div>
                        <div style="font-size: 32px; font-weight: 800; color: var(--primary-yellow); letter-spacing: 3px; margin-bottom: 15px;">${referralCode}</div>
                        <button class="checkout-button" onclick="copyReferralCode()" style="background: linear-gradient(135deg, #9C27B0, #673AB7); width: 100%;">
                            <i class="fas fa-copy"></i>
                            Copier le code
                        </button>
                    </div>
                    
                    <div class="referral-stats" style="margin-top: 20px;">
                        <div class="stat-item">
                            <div class="stat-value">${referralCount}</div>
                            <div class="stat-label">Parrainages</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${referralEarnings}â‚¬</div>
                            <div class="stat-label">Gains</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; font-size: 12px; color: var(--gray-300);">
                        <strong>Comment Ã§a marche ?</strong><br>
                        1. Partagez votre code avec vos amis<br>
                        2. Vos amis utilisent votre code lors de leur premiÃ¨re commande<br>
                        3. Vous recevez 10â‚¬ sur votre compte dÃ¨s que leur commande est validÃ©e
                    </div>
                </div>
            `;
            
            showCustomModal('ðŸ¤ Programme de Parrainage', html);
            toggleMenu();
        }
        
        function showCustomModal(title, content) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                backdrop-filter: blur(5px);
                z-index: 2000;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 15px;
                animation: fadeIn 0.3s ease-out;
            `;
            
            modal.innerHTML = `
                <div style="background: linear-gradient(135deg, #111111 0%, #1a1a1a 100%); border-radius: var(--radius-xl); width: 100%; max-width: 400px; max-height: 85vh; overflow-y: auto; animation: modalSlideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: var(--shadow-xl); position: relative; border: 1px solid rgba(255, 215, 0, 0.2);">
                    <div style="padding: 20px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); display: flex; justify-content: space-between; align-items: center; background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 152, 0, 0.1)); border-radius: var(--radius-xl) var(--radius-xl) 0 0;">
                        <div style="font-size: 20px; font-weight: 800; color: var(--text-color); display: flex; align-items: center; gap: 10px;">
                            ${title}
                        </div>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); color: var(--text-color); width: 35px; height: 35px; border-radius: var(--radius-full); font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s;">
                            Ã—
                        </button>
                    </div>
                    <div style="padding: 20px;">
                        ${content}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Fermer en cliquant Ã  l'extÃ©rieur
            modal.onclick = function(e) {
                if (e.target === modal) modal.remove();
            };
            
            // Fermer avec Escape
            document.addEventListener('keydown', function closeOnEscape(e) {
                if (e.key === 'Escape') {
                    modal.remove();
                    document.removeEventListener('keydown', closeOnEscape);
                }
            });
        }
    </script>
</body>
</html>
